import{b as Ni,d as Mi,e as Li,f as Fi,g as ji}from"./chunk-SE7GYV7H.js";import{a as wi,b as Ei}from"./chunk-A37OMXBV.js";import{a as zi,b as Vi,c as qi}from"./chunk-42CEJQHG.js";import{a as Ti,b as _i,e as Ci,g as Ri,h as Pi,i as Di,l as ki,m as $i,n as Bi,o as Ui}from"./chunk-F55UKRR4.js";import{g as Ii,h as Si,x as Ai,z as vi}from"./chunk-CHPS3FGF.js";import{L as Oi,a as xi}from"./chunk-IA2YBQXY.js";import{b as bi,i as $n}from"./chunk-6XJ4HP3E.js";import"./chunk-Q64FFBLU.js";import{$b as kn,Ab as Je,Ea as ai,Fa as ci,Gb as li,Hb as di,Ib as hi,Jb as J,Kb as K,Lb as Pn,Nb as ui,Oc as gi,Pc as pi,Qb as wt,Sb as Dn,Sc as yi,_b as ae,a as yt,bc as mi,cc as nt,d as Tt,dc as rt,e as re,ec as it,f as si,g as ea,gb as be,h as bt,hb as fi,j as _t,k as _n,l as Cn,m as Rn,ma as Yt,wa as oi,x as Jt,xa as Gt,y as Kt,yb as Zt}from"./chunk-AS4WY6AT.js";var Wi=re(()=>{"use strict";ArrayBuffer.isView||(ArrayBuffer.isView=t=>t!==null&&typeof t=="object"&&t.buffer instanceof ArrayBuffer);typeof FormData>"u"&&(global.FormData=class{});typeof globalThis>"u"&&typeof window<"u"&&(window.globalThis=window)});var Rt=re(Ct=>{"use strict";Ct.CloseCode=void 0;(function(t){t[t.CONSENTED=4e3]="CONSENTED",t[t.DEVMODE_RESTART=4010]="DEVMODE_RESTART"})(Ct.CloseCode||(Ct.CloseCode={}));var Nn=class extends Error{constructor(n,s){super(s),this.name="ServerError",this.code=n}};Ct.ServerError=Nn});var Ji=re((Sc,Hi)=>{"use strict";Hi.exports=function(n){return n&&typeof n=="object"&&typeof n.copy=="function"&&typeof n.fill=="function"&&typeof n.readUInt8=="function"}});var Ki=re((Ac,Mn)=>{"use strict";typeof Object.create=="function"?Mn.exports=function(n,s){n.super_=s,n.prototype=Object.create(s.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}})}:Mn.exports=function(n,s){n.super_=s;var a=function(){};a.prototype=s.prototype,n.prototype=new a,n.prototype.constructor=n}});var Xi=re(W=>{"use strict";var ta=/%[sdj%]/g;W.format=function(t){if(!sn(t)){for(var n=[],s=0;s<arguments.length;s++)n.push(Ke(arguments[s]));return n.join(" ")}for(var s=1,a=arguments,f=a.length,d=String(t).replace(ta,function(x){if(x==="%%")return"%";if(s>=f)return x;switch(x){case"%s":return String(a[s++]);case"%d":return Number(a[s++]);case"%j":try{return JSON.stringify(a[s++])}catch{return"[Circular]"}default:return x}}),u=a[s];s<f;u=a[++s])rn(u)||!Et(u)?d+=" "+u:d+=" "+Ke(u);return d};W.deprecate=function(t,n){if(je(global.process))return function(){return W.deprecate(t,n).apply(this,arguments)};if(process.noDeprecation===!0)return t;var s=!1;function a(){if(!s){if(process.throwDeprecation)throw new Error(n);process.traceDeprecation?console.trace(n):console.error(n),s=!0}return t.apply(this,arguments)}return a};var Xt={},Ln;W.debuglog=function(t){if(je(Ln)&&(Ln=process.env.NODE_DEBUG||""),t=t.toUpperCase(),!Xt[t])if(new RegExp("\\b"+t+"\\b","i").test(Ln)){var n=process.pid;Xt[t]=function(){var s=W.format.apply(W,arguments);console.error("%s %d: %s",t,n,s)}}else Xt[t]=function(){};return Xt[t]};function Ke(t,n){var s={seen:[],stylize:ra};return arguments.length>=3&&(s.depth=arguments[2]),arguments.length>=4&&(s.colors=arguments[3]),zn(n)?s.showHidden=n:n&&W._extend(s,n),je(s.showHidden)&&(s.showHidden=!1),je(s.depth)&&(s.depth=2),je(s.colors)&&(s.colors=!1),je(s.customInspect)&&(s.customInspect=!0),s.colors&&(s.stylize=na),nn(s,t,s.depth)}W.inspect=Ke;Ke.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};Ke.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function na(t,n){var s=Ke.styles[n];return s?"\x1B["+Ke.colors[s][0]+"m"+t+"\x1B["+Ke.colors[s][1]+"m":t}function ra(t,n){return t}function ia(t){var n={};return t.forEach(function(s,a){n[s]=!0}),n}function nn(t,n,s){if(t.customInspect&&n&&tn(n.inspect)&&n.inspect!==W.inspect&&!(n.constructor&&n.constructor.prototype===n)){var a=n.inspect(s,t);return sn(a)||(a=nn(t,a,s)),a}var f=sa(t,n);if(f)return f;var d=Object.keys(n),u=ia(d);if(t.showHidden&&(d=Object.getOwnPropertyNames(n)),en(n)&&(d.indexOf("message")>=0||d.indexOf("description")>=0))return Bn(n);if(d.length===0){if(tn(n)){var x=n.name?": "+n.name:"";return t.stylize("[Function"+x+"]","special")}if(Qt(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(Un(n))return t.stylize(Date.prototype.toString.call(n),"date");if(en(n))return Bn(n)}var T="",y=!1,N=["{","}"];if(Yi(n)&&(y=!0,N=["[","]"]),tn(n)){var F=n.name?": "+n.name:"";T=" [Function"+F+"]"}if(Qt(n)&&(T=" "+RegExp.prototype.toString.call(n)),Un(n)&&(T=" "+Date.prototype.toUTCString.call(n)),en(n)&&(T=" "+Bn(n)),d.length===0&&(!y||n.length==0))return N[0]+T+N[1];if(s<0)return Qt(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special");t.seen.push(n);var Q;return y?Q=oa(t,n,s,u,d):Q=d.map(function(H){return jn(t,n,s,u,H,y)}),t.seen.pop(),aa(Q,T,N)}function sa(t,n){if(je(n))return t.stylize("undefined","undefined");if(sn(n)){var s="'"+JSON.stringify(n).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(s,"string")}if(Gi(n))return t.stylize(""+n,"number");if(zn(n))return t.stylize(""+n,"boolean");if(rn(n))return t.stylize("null","null")}function Bn(t){return"["+Error.prototype.toString.call(t)+"]"}function oa(t,n,s,a,f){for(var d=[],u=0,x=n.length;u<x;++u)Zi(n,String(u))?d.push(jn(t,n,s,a,String(u),!0)):d.push("");return f.forEach(function(T){T.match(/^\d+$/)||d.push(jn(t,n,s,a,T,!0))}),d}function jn(t,n,s,a,f,d){var u,x,T;if(T=Object.getOwnPropertyDescriptor(n,f)||{value:n[f]},T.get?T.set?x=t.stylize("[Getter/Setter]","special"):x=t.stylize("[Getter]","special"):T.set&&(x=t.stylize("[Setter]","special")),Zi(a,f)||(u="["+f+"]"),x||(t.seen.indexOf(T.value)<0?(rn(s)?x=nn(t,T.value,null):x=nn(t,T.value,s-1),x.indexOf(`
`)>-1&&(d?x=x.split(`
`).map(function(y){return"  "+y}).join(`
`).substr(2):x=`
`+x.split(`
`).map(function(y){return"   "+y}).join(`
`))):x=t.stylize("[Circular]","special")),je(u)){if(d&&f.match(/^\d+$/))return x;u=JSON.stringify(""+f),u.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(u=u.substr(1,u.length-2),u=t.stylize(u,"name")):(u=u.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),u=t.stylize(u,"string"))}return u+": "+x}function aa(t,n,s){var a=0,f=t.reduce(function(d,u){return a++,u.indexOf(`
`)>=0&&a++,d+u.replace(/\u001b\[\d\d?m/g,"").length+1},0);return f>60?s[0]+(n===""?"":n+`
 `)+" "+t.join(`,
  `)+" "+s[1]:s[0]+n+" "+t.join(", ")+" "+s[1]}function Yi(t){return Array.isArray(t)}W.isArray=Yi;function zn(t){return typeof t=="boolean"}W.isBoolean=zn;function rn(t){return t===null}W.isNull=rn;function ca(t){return t==null}W.isNullOrUndefined=ca;function Gi(t){return typeof t=="number"}W.isNumber=Gi;function sn(t){return typeof t=="string"}W.isString=sn;function fa(t){return typeof t=="symbol"}W.isSymbol=fa;function je(t){return t===void 0}W.isUndefined=je;function Qt(t){return Et(t)&&Vn(t)==="[object RegExp]"}W.isRegExp=Qt;function Et(t){return typeof t=="object"&&t!==null}W.isObject=Et;function Un(t){return Et(t)&&Vn(t)==="[object Date]"}W.isDate=Un;function en(t){return Et(t)&&(Vn(t)==="[object Error]"||t instanceof Error)}W.isError=en;function tn(t){return typeof t=="function"}W.isFunction=tn;function la(t){return t===null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||typeof t=="symbol"||typeof t>"u"}W.isPrimitive=la;W.isBuffer=Ji();function Vn(t){return Object.prototype.toString.call(t)}function Fn(t){return t<10?"0"+t.toString(10):t.toString(10)}var da=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function ha(){var t=new Date,n=[Fn(t.getHours()),Fn(t.getMinutes()),Fn(t.getSeconds())].join(":");return[t.getDate(),da[t.getMonth()],n].join(" ")}W.log=function(){console.log("%s - %s",ha(),W.format.apply(W,arguments))};W.inherits=Ki();W._extend=function(t,n){if(!n||!Et(n))return t;for(var s=Object.keys(n),a=s.length;a--;)t[s[a]]=n[s[a]];return t};function Zi(t,n){return Object.prototype.hasOwnProperty.call(t,n)}});var an=re((on,Qi)=>{"use strict";(function(t,n){typeof on=="object"&&typeof Qi<"u"?n(on,Xi()):typeof define=="function"&&define.amd?define(["exports","util"],n):(t=typeof globalThis<"u"?globalThis:t||self,n(t.schema={}))})(on,function(t){"use strict";t.OPERATION=void 0,function(c){c[c.ADD=128]="ADD",c[c.REPLACE=0]="REPLACE",c[c.DELETE=64]="DELETE",c[c.DELETE_AND_MOVE=96]="DELETE_AND_MOVE",c[c.MOVE_AND_ADD=160]="MOVE_AND_ADD",c[c.DELETE_AND_ADD=192]="DELETE_AND_ADD",c[c.CLEAR=10]="CLEAR",c[c.REVERSE=15]="REVERSE",c[c.MOVE=32]="MOVE",c[c.DELETE_BY_REFID=33]="DELETE_BY_REFID",c[c.ADD_BY_REFID=129]="ADD_BY_REFID"}(t.OPERATION||(t.OPERATION={})),Symbol.metadata??=Symbol.for("Symbol.metadata");let a=Symbol("$track"),f=Symbol("$encoder"),d=Symbol("$decoder"),u=Symbol("$filter"),x=Symbol("$getByIndex"),T=Symbol("$deleteByIndex"),y=Symbol("$changes"),N=Symbol("$childType"),F=Symbol("$onEncodeEnd"),Q=Symbol("$onDecodeEnd"),H=Symbol("$descriptors"),ee="$__numFields",te="$__refTypeFieldIndexes",oe="$__viewFieldIndexes",Se="$__fieldIndexesByViewTag",ft;try{ft=new TextEncoder}catch{}let Xe=new ArrayBuffer(8),Re=new Int32Array(Xe),G=new Float32Array(Xe),Lt=new Float64Array(Xe),It=new BigInt64Array(Xe),Qe=typeof Buffer<"u"&&Buffer.byteLength?Buffer.byteLength:function(c,i){for(var e=0,r=0,o=0,l=c.length;o<l;o++)e=c.charCodeAt(o),e<128?r+=1:e<2048?r+=2:e<55296||e>=57344?r+=3:(o++,r+=4);return r};function Pe(c,i,e){for(var r=0,o=0,l=i.length;o<l;o++)r=i.charCodeAt(o),r<128?c[e.offset++]=r:r<2048?(c[e.offset]=192|r>>6,c[e.offset+1]=128|r&63,e.offset+=2):r<55296||r>=57344?(c[e.offset]=224|r>>12,c[e.offset+1]=128|r>>6&63,c[e.offset+2]=128|r&63,e.offset+=3):(o++,r=65536+((r&1023)<<10|i.charCodeAt(o)&1023),c[e.offset]=240|r>>18,c[e.offset+1]=128|r>>12&63,c[e.offset+2]=128|r>>6&63,c[e.offset+3]=128|r&63,e.offset+=4)}function lt(c,i,e){c[e.offset++]=i&255}function Bt(c,i,e){c[e.offset++]=i&255}function Ft(c,i,e){c[e.offset++]=i&255,c[e.offset++]=i>>8&255}function w(c,i,e){c[e.offset++]=i&255,c[e.offset++]=i>>8&255}function C(c,i,e){c[e.offset++]=i&255,c[e.offset++]=i>>8&255,c[e.offset++]=i>>16&255,c[e.offset++]=i>>24&255}function v(c,i,e){let r=i>>24,o=i>>16,l=i>>8,h=i;c[e.offset++]=h&255,c[e.offset++]=l&255,c[e.offset++]=o&255,c[e.offset++]=r&255}function A(c,i,e){let r=Math.floor(i/Math.pow(2,32)),o=i>>>0;v(c,o,e),v(c,r,e)}function P(c,i,e){let r=i/Math.pow(2,32)>>0,o=i>>>0;v(c,o,e),v(c,r,e)}function L(c,i,e){It[0]=BigInt.asIntN(64,i),C(c,Re[0],e),C(c,Re[1],e)}function U(c,i,e){It[0]=BigInt.asIntN(64,i),C(c,Re[0],e),C(c,Re[1],e)}function B(c,i,e){G[0]=i,C(c,Re[0],e)}function V(c,i,e){Lt[0]=i,C(c,Re[0],e),C(c,Re[1],e)}function q(c,i,e){c[e.offset++]=i?1:0}function Ae(c,i,e){i||(i="");let r=Qe(i,"utf8"),o=0;if(r<32)c[e.offset++]=r|160,o=1;else if(r<256)c[e.offset++]=217,c[e.offset++]=r%255,o=2;else if(r<65536)c[e.offset++]=218,w(c,r,e),o=3;else if(r<4294967296)c[e.offset++]=219,v(c,r,e),o=5;else throw new Error("String too long");return Pe(c,i,e),o+r}function ve(c,i,e){if(isNaN(i))return ve(c,0,e);if(isFinite(i)){if(i!==(i|0))return Math.abs(i)<=34028235e31&&(G[0]=i,Math.abs(Math.abs(G[0])-Math.abs(i))<1e-4)?(c[e.offset++]=202,B(c,i,e),5):(c[e.offset++]=203,V(c,i,e),9)}else return ve(c,i>0?Number.MAX_SAFE_INTEGER:-Number.MAX_SAFE_INTEGER,e);return i>=0?i<128?(c[e.offset++]=i&255,1):i<256?(c[e.offset++]=204,c[e.offset++]=i&255,2):i<65536?(c[e.offset++]=205,w(c,i,e),3):i<4294967296?(c[e.offset++]=206,v(c,i,e),5):(c[e.offset++]=207,P(c,i,e),9):i>=-32?(c[e.offset++]=224|i+32,1):i>=-128?(c[e.offset++]=208,lt(c,i,e),2):i>=-32768?(c[e.offset++]=209,Ft(c,i,e),3):i>=-2147483648?(c[e.offset++]=210,C(c,i,e),5):(c[e.offset++]=211,A(c,i,e),9)}let he={int8:lt,uint8:Bt,int16:Ft,uint16:w,int32:C,uint32:v,int64:A,uint64:P,bigint64:L,biguint64:U,float32:B,float64:V,boolean:q,string:Ae,number:ve,utf8Write:Pe,utf8Length:Qe},St=new ArrayBuffer(8),et=new Int32Array(St),Ro=new Float32Array(St),Po=new Float64Array(St),Do=new BigUint64Array(St),ko=new BigInt64Array(St);function Cr(c,i,e){for(var r="",o=0,l=i.offset,h=i.offset+e;l<h;l++){var E=c[l];if(!(E&128)){r+=String.fromCharCode(E);continue}if((E&224)===192){r+=String.fromCharCode((E&31)<<6|c[++l]&63);continue}if((E&240)===224){r+=String.fromCharCode((E&15)<<12|(c[++l]&63)<<6|(c[++l]&63)<<0);continue}if((E&248)===240){o=(E&7)<<18|(c[++l]&63)<<12|(c[++l]&63)<<6|(c[++l]&63)<<0,o>=65536?(o-=65536,r+=String.fromCharCode((o>>>10)+55296,(o&1023)+56320)):r+=String.fromCharCode(o);continue}console.error("Invalid byte "+E.toString(16))}return i.offset+=e,r}function Rr(c,i){return At(c,i)<<24>>24}function At(c,i){return c[i.offset++]}function Pr(c,i){return jt(c,i)<<16>>16}function jt(c,i){return c[i.offset++]|c[i.offset++]<<8}function De(c,i){return c[i.offset++]|c[i.offset++]<<8|c[i.offset++]<<16|c[i.offset++]<<24}function dt(c,i){return De(c,i)>>>0}function Dr(c,i){return et[0]=De(c,i),Ro[0]}function kr(c,i){return et[0]=De(c,i),et[1]=De(c,i),Po[0]}function $r(c,i){let e=dt(c,i);return De(c,i)*Math.pow(2,32)+e}function Nr(c,i){let e=dt(c,i);return dt(c,i)*Math.pow(2,32)+e}function $o(c,i){return et[0]=De(c,i),et[1]=De(c,i),ko[0]}function No(c,i){return et[0]=De(c,i),et[1]=De(c,i),Do[0]}function Mo(c,i){return At(c,i)>0}function Lo(c,i){let e=c[i.offset++],r;return e<192?r=e&31:e===217?r=At(c,i):e===218?r=jt(c,i):e===219&&(r=dt(c,i)),Cr(c,i,r)}function Bo(c,i){let e=c[i.offset++];if(e<128)return e;if(e===202)return Dr(c,i);if(e===203)return kr(c,i);if(e===204)return At(c,i);if(e===205)return jt(c,i);if(e===206)return dt(c,i);if(e===207)return Nr(c,i);if(e===208)return Rr(c,i);if(e===209)return Pr(c,i);if(e===210)return De(c,i);if(e===211)return $r(c,i);if(e>223)return(255-e+1)*-1}function Fo(c,i){let e=c[i.offset];return e<192&&e>160||e===217||e===218||e===219}let xe={utf8Read:Cr,int8:Rr,uint8:At,int16:Pr,uint16:jt,int32:De,uint32:dt,float32:Dr,float64:kr,int64:$r,uint64:Nr,bigint64:$o,biguint64:No,boolean:Mo,string:Lo,number:Bo,stringCheck:Fo},Mr={},jo=new Map;function Me(c,i){i.constructor&&(jo.set(i.constructor,c),Mr[c]=i),i.encode&&(he[c]=i.encode),i.decode&&(xe[c]=i.decode)}function vt(c){return Mr[c]}function Uo(c){for(let i in c)Me(i,c[i]);return i=>ke(i)}class pe{static{this.inheritedTypes=new Map}static{this.cachedContexts=new Map}static register(i){let e=Object.getPrototypeOf(i);if(e!==ce){let r=pe.inheritedTypes.get(e);r||(r=new Set,pe.inheritedTypes.set(e,r)),r.add(i)}}static cache(i){let e=pe.cachedContexts.get(i);return e||(e=new pe(i),pe.cachedContexts.set(i,e)),e}constructor(i){this.types={},this.schemas=new Map,this.hasFilters=!1,this.parentFiltered={},i&&this.discoverTypes(i)}has(i){return this.schemas.has(i)}get(i){return this.types[i]}add(i,e=this.schemas.size){return this.schemas.has(i)?!1:(this.types[e]=i,i[Symbol.metadata]===void 0&&ue.initialize(i),this.schemas.set(i,e),!0)}getTypeId(i){return this.schemas.get(i)}discoverTypes(i,e,r,o){if(o&&this.registerFilteredByParent(i,e,r),!this.add(i))return;pe.inheritedTypes.get(i)?.forEach(E=>{this.discoverTypes(E,e,r,o)});let l=i;for(;(l=Object.getPrototypeOf(l))&&l!==ce&&l!==Function.prototype;)this.discoverTypes(l);let h=i[Symbol.metadata]??={};h[oe]&&(this.hasFilters=!0);for(let E in h){let b=E,I=h[b].type,S=h[b].tag!==void 0;if(typeof I!="string")if(Array.isArray(I)){let O=I[0];if(O==="string")continue;this.discoverTypes(O,i,b,o||S)}else if(typeof I=="function")this.discoverTypes(I,i,b,o||S);else{let O=Object.values(I)[0];if(typeof O=="string")continue;this.discoverTypes(O,i,b,o||S)}}}registerFilteredByParent(i,e,r){let l=`${this.schemas.get(i)??this.schemas.size}`;e&&(l+=`-${this.schemas.get(e)}`),l+=`-${r}`,this.parentFiltered[l]=!0}debug(){let i="";for(let e in this.parentFiltered){let r=e.split("-").map(Number),o=r.pop();i+=`
		`,i+=`${e}: ${r.reverse().map((l,h)=>{let E=this.types[l],b=E[Symbol.metadata],I=E.name;return h===0&&(I+=`[${b[o].name}]`),`${I}`}).join(" -> ")}`}return`TypeContext ->
	Schema types: ${this.schemas.size}
	hasFilters: ${this.hasFilters}
	parentFiltered:${i}`}}function Lr(c){return Array.isArray(c)?{array:c[0]}:typeof c.type<"u"?c.type:c}let ue={addField(c,i,e,r,o){if(i>64)throw new Error(`Can't define field '${e}'.
Schema instances may only have up to 64 fields.`);c[i]=Object.assign(c[i]||{},{type:Lr(r),index:i,name:e}),Object.defineProperty(c,H,{value:c[H]||{},enumerable:!1,configurable:!0}),o?(c[H][e]=o,c[H][`_${e}`]={value:void 0,writable:!0,enumerable:!1,configurable:!0}):c[H][e]={value:void 0,writable:!0,enumerable:!0,configurable:!0},Object.defineProperty(c,ee,{value:i,enumerable:!1,configurable:!0}),Object.defineProperty(c,e,{value:i,enumerable:!1,configurable:!0}),typeof c[i].type!="string"&&(c[te]===void 0&&Object.defineProperty(c,te,{value:[],enumerable:!1,configurable:!0}),c[te].push(i))},setTag(c,i,e){let r=c[i],o=c[r];o.tag=e,c[oe]||(Object.defineProperty(c,oe,{value:[],enumerable:!1,configurable:!0}),Object.defineProperty(c,Se,{value:{},enumerable:!1,configurable:!0})),c[oe].push(r),c[Se][e]||(c[Se][e]=[]),c[Se][e].push(r)},setFields(c,i){let e=c.prototype.constructor;pe.register(e);let r=Object.getPrototypeOf(e),o=r&&r[Symbol.metadata],l=ue.initialize(e);e[a]||(e[a]=ce[a]),e[f]||(e[f]=ce[f]),e[d]||(e[d]=ce[d]),e.prototype.toJSON||(e.prototype.toJSON=ce.prototype.toJSON);let h=l[ee]??(o&&o[ee])??-1;h++;for(let E in i){let b=i[E],I=Array.isArray(b)?vt("array"):typeof Object.keys(b)[0]=="string"&&vt(Object.keys(b)[0]),S=I?Object.values(b)[0]:Lr(b);ue.addField(l,h,E,b,Yr(`_${E}`,h,S,I)),h++}return c},isDeprecated(c,i){return c[i].deprecated===!0},init(c){let i={};c[Symbol.metadata]=i,Object.defineProperty(i,ee,{value:0,enumerable:!1,configurable:!0})},initialize(c){let i=Object.getPrototypeOf(c),e=i[Symbol.metadata],r=c[Symbol.metadata]??Object.create(null);return i!==ce&&r===e&&(r=Object.create(null),e&&(Object.setPrototypeOf(r,e),Object.defineProperty(r,ee,{value:e[ee],enumerable:!1,configurable:!0,writable:!0}),e[oe]!==void 0&&(Object.defineProperty(r,oe,{value:[...e[oe]],enumerable:!1,configurable:!0,writable:!0}),Object.defineProperty(r,Se,{value:yt({},e[Se]),enumerable:!1,configurable:!0,writable:!0})),e[te]!==void 0&&Object.defineProperty(r,te,{value:[...e[te]],enumerable:!1,configurable:!0,writable:!0}),Object.defineProperty(r,H,{value:yt({},e[H]),enumerable:!1,configurable:!0,writable:!0}))),c[Symbol.metadata]=r,r},isValidInstance(c){return c.constructor[Symbol.metadata]&&Object.prototype.hasOwnProperty.call(c.constructor[Symbol.metadata],ee)},getFields(c){let i=c[Symbol.metadata],e={};for(let r=0;r<=i[ee];r++)e[i[r].name]=i[r].type;return e}};function Ut(){return{indexes:{},operations:[]}}function Oe(c,i){let e=c.indexes[i];e===void 0?c.indexes[i]=c.operations.push(i)-1:c.operations[e]=i}function Br(c,i){let e=c.indexes[i];e===void 0&&(e=Object.values(c.indexes).at(-1),i=Object.entries(c.indexes).find(([r,o])=>o===e)?.[0]),c.operations[e]=void 0,delete c.indexes[i]}function Ee(c,i,e,r=i[e].queueRootIndex){if(c)c[e][r]!==i&&(i[e].queueRootIndex=c[e].push(i)-1);else return}class ht{constructor(i){this.isFiltered=!1,this.indexedOperations={},this.changes={indexes:{},operations:[]},this.allChanges={indexes:{},operations:[]},this.isNew=!0,this.ref=i,i.constructor[Symbol.metadata]?.[oe]&&(this.allFilteredChanges={indexes:{},operations:[]},this.filteredChanges={indexes:{},operations:[]})}setRoot(i){this.root=i,this.checkIsFiltered(this.parent,this.parentIndex);let e=this.ref.constructor[Symbol.metadata];e?e[te]?.forEach(r=>{let o=e[r];this.ref[o.name]?.[y].setRoot(i)}):this.ref[N]&&typeof this.ref[N]!="string"&&this.ref.forEach((r,o)=>{r[y].setRoot(i)})}setParent(i,e,r){if(this.parent=i,this.parentIndex=r,!e)return;e!==this.root?(this.root=e,this.checkIsFiltered(i,r)):e.add(this);let o=this.ref.constructor[Symbol.metadata];o?o[te]?.forEach(l=>{let h=o[l];this.ref[h.name]?.[y].setParent(this.ref,e,l)}):this.ref[N]&&typeof this.ref[N]!="string"&&this.ref.forEach((l,h)=>{l[y].setParent(this.ref,e,this.indexes[h]??h)})}forEachChild(i){let e=this.ref.constructor[Symbol.metadata];e?e[te]?.forEach(r=>{let o=e[r],l=this.ref[o.name];l&&i(l[y],r)}):this.ref[N]&&typeof this.ref[N]!="string"&&this.ref.forEach((r,o)=>{i(r[y],this.indexes[o]??o)})}operation(i){this.changes.operations.push(-i),Ee(this.root,this,"changes")}change(i,e=t.OPERATION.ADD){let r=this.ref.constructor[Symbol.metadata],o=this.isFiltered||r?.[i]?.tag!==void 0,l=o?this.filteredChanges:this.changes,h=this.indexedOperations[i];if(!h||h===t.OPERATION.DELETE){let E=h&&h===t.OPERATION.DELETE?t.OPERATION.DELETE_AND_ADD:e;this.indexedOperations[i]=E}Oe(l,i),o?(Oe(this.allFilteredChanges,i),this.root&&(Ee(this.root,this,"filteredChanges"),Ee(this.root,this,"allFilteredChanges"))):(Oe(this.allChanges,i),Ee(this.root,this,"changes"))}shiftChangeIndexes(i){let e=this.isFiltered?this.filteredChanges:this.changes,r={},o={};for(let l in this.indexedOperations)r[Number(l)+i]=this.indexedOperations[l],o[Number(l)+i]=e.indexes[l];this.indexedOperations=r,e.indexes=o,e.operations=e.operations.map(l=>l+i)}shiftAllChangeIndexes(i,e=0){this.filteredChanges!==void 0?(this._shiftAllChangeIndexes(i,e,this.allFilteredChanges),this._shiftAllChangeIndexes(i,e,this.allChanges)):this._shiftAllChangeIndexes(i,e,this.allChanges)}_shiftAllChangeIndexes(i,e=0,r){let o={},l=0;for(let h in r.indexes)o[l++]=r.indexes[h];r.indexes=o;for(let h=0;h<r.operations.length;h++){let E=r.operations[h];E>e&&(r.operations[h]=E+i)}}indexedOperation(i,e,r=i){this.indexedOperations[i]=e,this.filteredChanges!==void 0?(Oe(this.allFilteredChanges,r),Oe(this.filteredChanges,i),Ee(this.root,this,"filteredChanges")):(Oe(this.allChanges,r),Oe(this.changes,i),Ee(this.root,this,"changes"))}getType(i){return ue.isValidInstance(this.ref)?this.ref.constructor[Symbol.metadata][i].type:this.ref[N]}getChange(i){return this.indexedOperations[i]}getValue(i,e=!1){return this.ref[x](i,e)}delete(i,e,r=i){if(i===void 0){try{throw new Error(`@colyseus/schema ${this.ref.constructor.name}: trying to delete non-existing index '${i}'`)}catch(h){console.warn(h)}return}let o=this.filteredChanges!==void 0?this.filteredChanges:this.changes;this.indexedOperations[i]=e??t.OPERATION.DELETE,Oe(o,i),Br(this.allChanges,r);let l=this.getValue(i);return l&&l[y]&&this.root?.remove(l[y]),this.filteredChanges!==void 0?(Br(this.allFilteredChanges,r),Ee(this.root,this,"filteredChanges")):Ee(this.root,this,"changes"),l}endEncode(i){this.indexedOperations={},this[i].indexes={},this[i].operations.length=0,this[i].queueRootIndex=void 0,this.ref[F]?.(),this.isNew=!1}discard(i=!1){this.ref[F]?.(),this.indexedOperations={},this.changes.indexes={},this.changes.operations.length=0,this.changes.queueRootIndex=void 0,this.filteredChanges!==void 0&&(this.filteredChanges.indexes={},this.filteredChanges.operations.length=0,this.filteredChanges.queueRootIndex=void 0),i&&(this.allChanges.indexes={},this.allChanges.operations.length=0,this.allFilteredChanges!==void 0&&(this.allFilteredChanges.indexes={},this.allFilteredChanges.operations.length=0),this.forEachChild((e,r)=>this.root?.remove(e)))}discardAll(){let i=Object.keys(this.indexedOperations);for(let e=0,r=i.length;e<r;e++){let o=this.getValue(Number(i[e]));o&&o[y]&&o[y].discardAll()}this.discard()}ensureRefId(){this.refId===void 0&&(this.refId=this.root.getNextUniqueId())}get changed(){return Object.entries(this.indexedOperations).length>0}checkIsFiltered(i,e){let r=this.root.add(this);this.root.types.hasFilters&&(this._checkFilteredByParent(i,e),this.filteredChanges!==void 0&&(Ee(this.root,this,"filteredChanges"),r&&this.root.allFilteredChanges.push(this))),this.isFiltered||(Ee(this.root,this,"changes"),r&&this.root.allChanges.push(this))}_checkFilteredByParent(i,e){if(!i)return;let r=ue.isValidInstance(this.ref)?this.ref.constructor:this.ref[N];if(!ue.isValidInstance(i)){let h=i[y];i=h.parent,e=h.parentIndex}let o=i.constructor,l=`${this.root.types.getTypeId(r)}`;o&&(l+=`-${this.root.types.schemas.get(o)}`),l+=`-${e}`,this.isFiltered=i[y].isFiltered||this.root.types.parentFiltered[l]||o?.[Symbol.metadata]?.[oe]?.includes(e),this.isFiltered&&(this.filteredChanges||(this.filteredChanges=Ut(),this.allFilteredChanges=Ut()),this.changes.operations.length>0&&(this.changes.operations.forEach(h=>Oe(this.filteredChanges,h)),this.allChanges.operations.forEach(h=>Oe(this.allFilteredChanges,h)),this.changes=Ut(),this.allChanges=Ut()))}}function In(c,i,e,r,o,l){typeof e=="string"?he[e]?.(i,r,l):e[Symbol.metadata]!==void 0?(he.number(i,r[y].refId,l),(o&t.OPERATION.ADD)===t.OPERATION.ADD&&c.tryEncodeTypeId(i,e,r.constructor,l)):he.number(i,r[y].refId,l)}let Fr=function(c,i,e,r,o,l,h,E,b){if(i[l.offset++]=(r|o)&255,o===t.OPERATION.DELETE)return;let I=e.ref,S=b[r];In(c,i,b[r].type,I[S.name],o,l)},zt=function(c,i,e,r,o,l){if(i[l.offset++]=o&255,o===t.OPERATION.CLEAR||(he.number(i,r,l),o===t.OPERATION.DELETE))return;let h=e.ref;if((o&t.OPERATION.ADD)===t.OPERATION.ADD&&typeof h.set=="function"){let I=e.ref.$indexes.get(r);he.string(i,I,l)}let E=h[N],b=h[x](r);In(c,i,E,b,o,l)},jr=function(c,i,e,r,o,l,h,E){let b=e.ref,I=E&&e.isFiltered&&typeof e.getType(r)!="string",S;if(I?(S=b.tmpItems[r][y].refId,o===t.OPERATION.DELETE?o=t.OPERATION.DELETE_BY_REFID:o===t.OPERATION.ADD&&(o=t.OPERATION.ADD_BY_REFID)):S=r,i[l.offset++]=o&255,o===t.OPERATION.CLEAR||o===t.OPERATION.REVERSE||(he.number(i,S,l),o===t.OPERATION.DELETE))return;let O=e.getType(r),k=e.getValue(r,h);In(c,i,O,k,o,l)},Ur=-1;function Sn(c,i,e,r,o,l,h,E){let b=c.root,I=e[x](r),S;if((i&t.OPERATION.DELETE)===t.OPERATION.DELETE){let O=b.refIds.get(I);O!==void 0&&b.removeRef(O),i!==t.OPERATION.DELETE_AND_ADD&&e[T](r),S=void 0}if(i!==t.OPERATION.DELETE)if(ce.is(o)){let O=xe.number(l,h);if(S=b.refs.get(O),(i&t.OPERATION.ADD)===t.OPERATION.ADD){let k=c.getInstanceType(l,h,o);S||(S=c.createInstanceOfType(k)),b.addRef(O,S,S!==I||i===t.OPERATION.DELETE_AND_ADD&&S===I)}}else if(typeof o=="string")S=xe[o](l,h);else{let O=vt(Object.keys(o)[0]),k=xe.number(l,h),M=b.refs.has(k)?I||b.refs.get(k):new O.constructor;if(S=M.clone(!0),S[N]=Object.values(o)[0],I){let R=b.refIds.get(I);if(R!==void 0&&k!==R){let _=I.entries(),$;for(;($=_.next())&&!$.done;){let[Z,ne]=$.value;typeof ne=="object"&&(R=b.refIds.get(ne),b.removeRef(R)),E.push({ref:I,refId:R,op:t.OPERATION.DELETE,field:Z,value:void 0,previousValue:ne})}}}b.addRef(k,S,M!==I||i===t.OPERATION.DELETE_AND_ADD&&M===I)}return{value:S,previousValue:I}}let zr=function(c,i,e,r,o){let l=i[e.offset++],h=r.constructor[Symbol.metadata],E=l>>6<<6,b=l%(E||255),I=h[b];if(I===void 0)return console.warn("@colyseus/schema: field not defined at",{index:b,ref:r.constructor.name,metadata:h}),Ur;let{value:S,previousValue:O}=Sn(c,E,r,b,I.type,i,e,o);S!=null&&(r[I.name]=S),O!==S&&o.push({ref:r,refId:c.currentRefId,op:E,field:I.name,value:S,previousValue:O})},Vt=function(c,i,e,r,o){let l=i[e.offset++];if(l===t.OPERATION.CLEAR){c.removeChildRefs(r,o),r.clear();return}let h=xe.number(i,e),E=r[N],b;(l&t.OPERATION.ADD)===t.OPERATION.ADD?typeof r.set=="function"?(b=xe.string(i,e),r.setIndex(h,b)):b=h:b=r.getIndex(h);let{value:I,previousValue:S}=Sn(c,l,r,h,E,i,e,o);if(I!=null){if(typeof r.set=="function")r.$items.set(b,I);else if(typeof r.$setAt=="function")r.$setAt(h,I,l);else if(typeof r.add=="function"){let O=r.add(I);typeof O=="number"&&r.setIndex(O,O)}}S!==I&&o.push({ref:r,refId:c.currentRefId,op:l,field:"",dynamicIndex:b,value:I,previousValue:S})},zo=function(c,i,e,r,o){let l=i[e.offset++],h;if(l===t.OPERATION.CLEAR){c.removeChildRefs(r,o),r.clear();return}else if(l===t.OPERATION.REVERSE){r.reverse();return}else if(l===t.OPERATION.DELETE_BY_REFID){let O=xe.number(i,e),k=c.root.refs.get(O);h=r.findIndex(M=>M===k),r[T](h),o.push({ref:r,refId:c.currentRefId,op:t.OPERATION.DELETE,field:"",dynamicIndex:h,value:void 0,previousValue:k});return}else if(l===t.OPERATION.ADD_BY_REFID){let O=xe.number(i,e),k=c.root.refs.get(O);h=k?r.findIndex(M=>M===k):r.length}else h=xe.number(i,e);let E=r[N],b=h,{value:I,previousValue:S}=Sn(c,l,r,h,E,i,e,o);I!=null&&I!==S&&r.$setAt(h,I,l),S!==I&&o.push({ref:r,refId:c.currentRefId,op:l,field:"",dynamicIndex:b,value:I,previousValue:S})};class Vr extends Error{}function Vo(c,i,e,r){let o,l=!1;switch(i){case"number":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":case"int64":case"uint64":case"float32":case"float64":o="number",isNaN(c)&&console.log(`trying to encode "NaN" in ${e.constructor.name}#${r}`);break;case"bigint64":case"biguint64":o="bigint";break;case"string":o="string",l=!0;break;case"boolean":return;default:return}if(typeof c!==o&&(!l||l&&c!==null)){let h=`'${JSON.stringify(c)}'${c&&c.constructor&&` (${c.constructor.name})`||""}`;throw new Vr(`a '${o}' was expected, but ${h} was provided in ${e.constructor.name}#${r}`)}}function qt(c,i,e,r){if(!(c instanceof i))throw new Vr(`a '${i.name}' was expected, but '${c&&c.constructor.name}' was provided in ${e.constructor.name}#${r}`)}var qr,Wr;let qo=(c,i)=>{let e=c.toString(),r=i.toString();return e<r?-1:e>r?1:0},qe=(()=>{class c{static{this[qr]=jr}static{this[Wr]=zo}static[(qr=f,Wr=d,u)](e,r,o){return!o||typeof e[N]=="string"||o.visible.has(e.tmpItems[r]?.[y])}static is(e){return Array.isArray(e)||e.array!==void 0}static from(e){return new c(...Array.from(e))}constructor(...e){this.items=[],this.tmpItems=[],this.deletedIndexes={},Object.defineProperty(this,N,{value:void 0,enumerable:!1,writable:!0,configurable:!0});let r=new Proxy(this,{get:(o,l)=>typeof l!="symbol"&&!isNaN(l)?this.items[l]:Reflect.get(o,l),set:(o,l,h)=>{if(typeof l!="symbol"&&!isNaN(l)){if(h==null)o.$deleteAt(l);else{if(h[y]){qt(h,o[N],o,l);let E=o.items[l];E!==void 0?(h[y].isNew?this[y].indexedOperation(Number(l),t.OPERATION.MOVE_AND_ADD):(o[y].getChange(Number(l))&t.OPERATION.DELETE)===t.OPERATION.DELETE?this[y].indexedOperation(Number(l),t.OPERATION.DELETE_AND_MOVE):this[y].indexedOperation(Number(l),t.OPERATION.MOVE),E[y].root?.remove(E[y])):h[y].isNew&&this[y].indexedOperation(Number(l),t.OPERATION.ADD),h[y].setParent(this,o[y].root,l)}else o.$changeAt(Number(l),h);this.items[l]=h,this.tmpItems[l]=h}return!0}else return Reflect.set(o,l,h)},deleteProperty:(o,l)=>(typeof l=="number"?o.$deleteAt(l):delete o[l],!0),has:(o,l)=>typeof l!="symbol"&&!isNaN(Number(l))?Reflect.has(this.items,l):Reflect.has(o,l)});return this[y]=new ht(r),this[y].indexes={},e.length>0&&this.push(...e),r}set length(e){e===0?this.clear():e<this.items.length?this.splice(e,this.length-e):console.warn("ArraySchema: can't set .length to a higher value than its length.")}get length(){return this.items.length}push(...e){let r=this.tmpItems.length,o=this[y];for(let l=0,h=e.length;l<e.length;l++,r++){let E=e[l];if(E==null)return;typeof E=="object"&&this[N]&&qt(E,this[N],this,l),o.indexedOperation(r,t.OPERATION.ADD,this.items.length),this.items.push(E),this.tmpItems.push(E),E[y]?.setParent(this,o.root,r)}return r}pop(){let e=-1;for(let r=this.tmpItems.length-1;r>=0;r--)if(this.deletedIndexes[r]!==!0){e=r;break}if(!(e<0))return this[y].delete(e,void 0,this.items.length-1),this.deletedIndexes[e]=!0,this.items.pop()}at(e){return e<0&&(e+=this.length),this.items[e]}$changeAt(e,r){if(r==null){console.error("ArraySchema items cannot be null nor undefined; Use `deleteAt(index)` instead.");return}if(this.items[e]===r)return;let o=this[y],l=o.indexes?.[e]?.op??t.OPERATION.ADD;o.change(e,l),r[y]?.setParent(this,o.root,e)}$deleteAt(e,r){this[y].delete(e,r)}$setAt(e,r,o){e===0&&o===t.OPERATION.ADD&&this.items[e]!==void 0?this.items.unshift(r):o===t.OPERATION.DELETE_AND_MOVE?(this.items.splice(e,1),this.items[e]=r):this.items[e]=r}clear(){if(this.items.length===0)return;let e=this[y];e.forEachChild((r,o)=>{r.discard(!0);let l=r.root;l!==void 0&&(l.removeChangeFromChangeSet("changes",r),l.removeChangeFromChangeSet("allChanges",r),l.removeChangeFromChangeSet("allFilteredChanges",r))}),e.discard(!0),e.operation(t.OPERATION.CLEAR),this.items.length=0,this.tmpItems.length=0}concat(...e){return new c(...this.items.concat(...e))}join(e){return this.items.join(e)}reverse(){return this[y].operation(t.OPERATION.REVERSE),this.items.reverse(),this.tmpItems.reverse(),this}shift(){if(this.items.length===0)return;let e=this[y],r=this.tmpItems.findIndex(l=>l===this.items[0]),o=this.items.findIndex(l=>l===this.items[0]);return e.delete(r,t.OPERATION.DELETE,o),e.shiftAllChangeIndexes(-1,o),this.items.shift()}slice(e,r){let o=new c;return o.push(...this.items.slice(e,r)),o}sort(e=qo){let r=this[y];return this.items.sort(e).forEach((l,h)=>r.change(h,t.OPERATION.REPLACE)),this.tmpItems.sort(e),this}splice(e,r,...o){let l=this[y],h=this.items.length,E=this.tmpItems.length,b=o.length,I=[];for(let S=0;S<E;S++)this.deletedIndexes[S]!==!0&&I.push(S);if(h>e){r===void 0&&(r=h-e);for(let S=e;S<e+r;S++){let O=I[S];l.delete(O,t.OPERATION.DELETE),this.deletedIndexes[O]=!0}}else r=0;if(b>0){if(b>r)throw console.error("Inserting more elements than deleting during ArraySchema#splice()"),new Error("ArraySchema#splice(): insertCount must be equal or lower than deleteCount.");for(let S=0;S<b;S++){let O=(I[e]??h)+S;l.indexedOperation(O,this.deletedIndexes[O]?t.OPERATION.DELETE_AND_ADD:t.OPERATION.ADD),o[S][y]?.setParent(this,l.root,O)}}return r>b&&l.shiftAllChangeIndexes(-(r-b),I[e+b]),l.filteredChanges!==void 0?Ee(l.root,l,"filteredChanges"):Ee(l.root,l,"changes"),this.items.splice(e,r,...o)}unshift(...e){let r=this[y];return r.shiftChangeIndexes(e.length),r.isFiltered?Oe(r.filteredChanges,this.items.length):Oe(r.allChanges,this.items.length),e.forEach((o,l)=>{r.change(l,t.OPERATION.ADD)}),this.tmpItems.unshift(...e),this.items.unshift(...e)}indexOf(e,r){return this.items.indexOf(e,r)}lastIndexOf(e,r=this.length-1){return this.items.lastIndexOf(e,r)}every(e,r){return this.items.every(e,r)}some(e,r){return this.items.some(e,r)}forEach(e,r){return this.items.forEach(e,r)}map(e,r){return this.items.map(e,r)}filter(e,r){return this.items.filter(e,r)}reduce(e,r){return this.items.reduce(e,r)}reduceRight(e,r){return this.items.reduceRight(e,r)}find(e,r){return this.items.find(e,r)}findIndex(e,r){return this.items.findIndex(e,r)}fill(e,r,o){throw new Error("ArraySchema#fill() not implemented")}copyWithin(e,r,o){throw new Error("ArraySchema#copyWithin() not implemented")}toString(){return this.items.toString()}toLocaleString(){return this.items.toLocaleString()}[Symbol.iterator](){return this.items[Symbol.iterator]()}static get[Symbol.species](){return c}entries(){return this.items.entries()}keys(){return this.items.keys()}values(){return this.items.values()}includes(e,r){return this.items.includes(e,r)}flatMap(e,r){throw new Error("ArraySchema#flatMap() is not supported.")}flat(e){throw new Error("ArraySchema#flat() is not supported.")}findLast(){return this.items.findLast.apply(this.items,arguments)}findLastIndex(...e){return this.items.findLastIndex.apply(this.items,arguments)}with(e,r){let o=this.items.slice();return e<0&&(e+=this.length),o[e]=r,new c(...o)}toReversed(){return this.items.slice().reverse()}toSorted(e){return this.items.slice().sort(e)}toSpliced(e,r,...o){return this.items.toSpliced.apply(copy,arguments)}[x](e,r=!1){return r?this.items[e]:this.deletedIndexes[e]?this.items[e]:this.tmpItems[e]||this.items[e]}[T](e){this.items[e]=void 0,this.tmpItems[e]=void 0}[F](){this.tmpItems=this.items.slice(),this.deletedIndexes={}}[Q](){this.items=this.items.filter(e=>e!==void 0),this.tmpItems=this.items.slice()}toArray(){return this.items.slice(0)}toJSON(){return this.toArray().map(e=>typeof e.toJSON=="function"?e.toJSON():e)}clone(e){let r;return e?(r=new c,r.push(...this.items)):r=new c(...this.map(o=>o[y]?o.clone():o)),r}}return c})();Me("array",{constructor:qe});var Hr,Jr;let ut=(()=>{class c{static{this[Hr]=zt}static{this[Jr]=Vt}static[(Hr=f,Jr=d,u)](e,r,o){return!o||typeof e[N]=="string"||o.visible.has((e[x](r)??e.deletedItems[r])[y])}static is(e){return e.map!==void 0}constructor(e){if(this.$items=new Map,this.$indexes=new Map,this.deletedItems={},this[y]=new ht(this),this[y].indexes={},e)if(e instanceof Map||e instanceof c)e.forEach((r,o)=>this.set(o,r));else for(let r in e)this.set(r,e[r]);Object.defineProperty(this,N,{value:void 0,enumerable:!1,writable:!0,configurable:!0})}[Symbol.iterator](){return this.$items[Symbol.iterator]()}get[Symbol.toStringTag](){return this.$items[Symbol.toStringTag]}static get[Symbol.species](){return c}set(e,r){if(r==null)throw new Error(`MapSchema#set('${e}', ${r}): trying to set ${r} value on '${e}'.`);typeof r=="object"&&this[N]&&qt(r,this[N],this,e),e=e.toString();let o=this[y],l=r[y]!==void 0,h,E;if(typeof o.indexes[e]<"u"){h=o.indexes[e],E=t.OPERATION.REPLACE;let b=this.$items.get(e);if(b===r)return;l&&(E=t.OPERATION.DELETE_AND_ADD,b!==void 0&&b[y].root?.remove(b[y]))}else h=o.indexes[ee]??0,E=t.OPERATION.ADD,this.$indexes.set(h,e),o.indexes[e]=h,o.indexes[ee]=h+1;return this.$items.set(e,r),o.change(h,E),l&&r[y].setParent(this,o.root,h),this}get(e){return this.$items.get(e)}delete(e){let r=this[y].indexes[e];return this.deletedItems[r]=this[y].delete(r),this.$items.delete(e)}clear(){let e=this[y];e.discard(!0),e.indexes={},this.$indexes.clear(),this.$items.clear(),e.operation(t.OPERATION.CLEAR)}has(e){return this.$items.has(e)}forEach(e){this.$items.forEach(e)}entries(){return this.$items.entries()}keys(){return this.$items.keys()}values(){return this.$items.values()}get size(){return this.$items.size}setIndex(e,r){this.$indexes.set(e,r)}getIndex(e){return this.$indexes.get(e)}[x](e){return this.$items.get(this.$indexes.get(e))}[T](e){let r=this.$indexes.get(e);this.$items.delete(r),this.$indexes.delete(e)}[F](){this.deletedItems={}}toJSON(){let e={};return this.forEach((r,o)=>{e[o]=typeof r.toJSON=="function"?r.toJSON():r}),e}clone(e){let r;return e?r=Object.assign(new c,this):(r=new c,this.forEach((o,l)=>{o[y]?r.set(l,o.clone()):r.set(l,o)})),r}}return c})();Me("map",{constructor:ut});let Fe=-1;function Wo(c){return pe.register(c),c}function Kr(c=Fe){return function(i,e){let r=i.constructor,l=Object.getPrototypeOf(r)[Symbol.metadata],h=r[Symbol.metadata]??=Object.assign({},r[Symbol.metadata],l??Object.create(null));ue.setTag(h,e,c)}}function ke(c,i){return function(e,r){let o=e.constructor;if(!c)throw new Error(`${o.name}: @type() reference provided for "${r}" is undefined. Make sure you don't have any circular dependencies.`);pe.register(o);let h=Object.getPrototypeOf(o)[Symbol.metadata],E=ue.initialize(o),b=E[r];if(E[b]!==void 0){if(E[b].deprecated)return;if(E[b].type!==void 0)try{throw new Error(`@colyseus/schema: Duplicate '${r}' definition on '${o.name}'.
Check @type() annotation`)}catch(I){let S=I.stack.split(`
`)[4].trim();throw new Error(`${I.message} ${S}`)}}else b=E[ee]??(h&&h[ee])??-1,b++;if(i&&i.manual)ue.addField(E,b,r,c,{enumerable:!0,configurable:!0,writable:!0});else{let I=Array.isArray(c)?vt("array"):typeof Object.keys(c)[0]=="string"&&vt(Object.keys(c)[0]),S=I?Object.values(c)[0]:c;ue.addField(E,b,r,c,Yr(`_${r}`,b,S,I))}}}function Yr(c,i,e,r){return{get:function(){return this[c]},set:function(o){let l=this[c]??void 0;if(o!==l){if(o!=null){r?(r.constructor===qe&&!(o instanceof qe)&&(o=new qe(...o)),r.constructor===ut&&!(o instanceof ut)&&(o=new ut(o)),o[N]=e):typeof e!="string"?qt(o,e,this,c.substring(1)):Vo(o,e,this,c.substring(1));let h=this[y];l!==void 0&&l[y]?(h.root?.remove(l[y]),this.constructor[a](h,i,t.OPERATION.DELETE_AND_ADD)):this.constructor[a](h,i,t.OPERATION.ADD),o[y]?.setParent(this,h.root,i)}else l!==void 0&&this[y].delete(i);this[c]=o}},enumerable:!0,configurable:!0}}function Ho(c=!0){return function(i,e){let r=i.constructor,l=Object.getPrototypeOf(r)[Symbol.metadata],h=r[Symbol.metadata]??=Object.assign({},r[Symbol.metadata],l??Object.create(null)),E=h[e];h[E].deprecated=!0,c&&(h[H]??={},h[H][e]={get:function(){throw new Error(`${e} is deprecated.`)},set:function(b){},enumerable:!1,configurable:!0}),Object.defineProperty(h,E,{value:h[E],enumerable:!1,configurable:!0})}}function Jo(c,i,e){for(let r in i)ke(i[r],e)(c.prototype,r);return c}function Gr(c,i,e=ce){let r={},o={};for(let h in c){let E=c[h];typeof E=="object"&&(E.default!==void 0&&(r[h]=E.default),E.view!==void 0&&(o[h]=typeof E.view=="boolean"?Fe:E.view))}let l=ue.setFields(class extends e{constructor(...h){h[0]=Object.assign({},r,h[0]),super(...h)}},c);for(let h in o)Kr(o[h])(l.prototype,h);return i&&Object.defineProperty(l,"name",{value:i}),l.extends=(h,E)=>Gr(h,E,l),l}function Wt(c){return new Array(c).fill(0).map((i,e)=>e===c-1?"\u2514\u2500 ":"   ").join("")}function Ko(c){let i=c[y].root,e={ops:{},refs:[]};return i.changes.forEach(r=>{let o=r.indexedOperations;e.refs.push(`refId#${r.refId}`);for(let l in o){let h=o[l],E=t.OPERATION[h];e.ops[E]||(e.ops[E]=0),e.ops[t.OPERATION[h]]++}}),e}var Zr,Xr;let ce=(()=>{class c{static{this[Zr]=Fr}static{this[Xr]=zr}static initialize(e){Object.defineProperty(e,y,{value:new ht(e),enumerable:!1,writable:!0}),Object.defineProperties(e,e.constructor[Symbol.metadata]?.[H]||{})}static is(e){return typeof e[Symbol.metadata]=="object"}static[(Zr=f,Xr=d,a)](e,r,o=t.OPERATION.ADD){e.change(r,o)}static[u](e,r,o){let h=e.constructor[Symbol.metadata][r]?.tag;if(o===void 0)return h===void 0;if(h===void 0)return!0;if(h===Fe)return o.visible.has(e[y]);{let E=o.tags?.get(e[y]);return E&&E.has(h)}}constructor(...e){c.initialize(this),e[0]&&Object.assign(this,e[0])}assign(e){return Object.assign(this,e),this}setDirty(e,r){let o=this.constructor[Symbol.metadata];this[y].change(o[o[e]].index,r)}clone(){let e=new this.constructor,r=this.constructor[Symbol.metadata];for(let o in r){let l=r[o].name;typeof this[l]=="object"&&typeof this[l]?.clone=="function"?e[l]=this[l].clone():e[l]=this[l]}return e}toJSON(){let e={},r=this.constructor[Symbol.metadata];for(let o in r){let l=r[o],h=l.name;!l.deprecated&&this[h]!==null&&typeof this[h]<"u"&&(e[h]=typeof this[h].toJSON=="function"?this[h].toJSON():this[h])}return e}discardAllChanges(){this[y].discardAll()}[x](e){let r=this.constructor[Symbol.metadata];return this[r[e].name]}[T](e){let r=this.constructor[Symbol.metadata];this[r[e].name]=void 0}static debugRefIds(e,r=!1,o=0){let l=r?` - ${JSON.stringify(e.toJSON())}`:"",h=e[y],E=h.refId,b="";return b+=`${Wt(o)}${e.constructor.name} (refId: ${E})${l}
`,h.forEachChild(I=>b+=this.debugRefIds(I.ref,r,o+1)),b}static debugChanges(e,r=!1){let o=e[y],l=r?o.allChanges:o.changes,h=r?"allChanges":"changes",E=`${e.constructor.name} (${o.refId}) -> .${h}:
`;function b(I){I.operations.filter(S=>S).forEach(S=>{let O=o.indexedOperations[S];console.log({index:S,operation:O}),E+=`- [${S}]: ${t.OPERATION[O]} (${JSON.stringify(o.getValue(Number(S),r))})
`})}return b(l),!r&&o.filteredChanges&&o.filteredChanges.operations.filter(I=>I).length>0&&(E+=`${e.constructor.name} (${o.refId}) -> .filteredChanges:
`,b(o.filteredChanges)),r&&o.allFilteredChanges&&o.allFilteredChanges.operations.filter(I=>I).length>0&&(E+=`${e.constructor.name} (${o.refId}) -> .allFilteredChanges:
`,b(o.allFilteredChanges)),E}static debugChangesDeep(e,r="changes"){let o="",l=e[y],h=l.root,E=new Map,b=[],I=0;for(let[O,k]of Object.entries(h[r])){let M=h.changeTrees[O],R=!1,_=[],$=M.parent?.[y];if(M===l)R=!0;else for(;$!==void 0;){if(_.push($),$.ref===e){R=!0;break}$=$.parent?.[y]}R&&(b.push(M.refId),I+=Object.keys(k).length,E.set(M,_.reverse()))}o+=`---
`,o+=`root refId: ${l.refId}
`,o+=`Total instances: ${b.length} (refIds: ${b.join(", ")})
`,o+=`Total changes: ${I}
`,o+=`---
`;let S=new WeakSet;for(let[O,k]of E.entries()){k.forEach((Z,ne)=>{S.has(Z)||(o+=`${Wt(ne)}${Z.ref.constructor.name} (refId: ${Z.refId})
`,S.add(Z))});let M=O.indexedOperations,R=k.length,_=Wt(R),$=R>0?`(${O.parentIndex}) `:"";o+=`${_}${$}${O.ref.constructor.name} (refId: ${O.refId}) - changes: ${Object.keys(M).length}
`;for(let Z in M){let ne=M[Z];o+=`${Wt(R+1)}${t.OPERATION[ne]}: ${Z}
`}}return`${o}`}}return c})();var Qr,ei;let An=(()=>{class c{static{this[Qr]=zt}static{this[ei]=Vt}static[(Qr=f,ei=d,u)](e,r,o){return!o||typeof e[N]=="string"||o.visible.has((e[x](r)??e.deletedItems[r])[y])}static is(e){return e.collection!==void 0}constructor(e){this.$items=new Map,this.$indexes=new Map,this.deletedItems={},this.$refId=0,this[y]=new ht(this),this[y].indexes={},e&&e.forEach(r=>this.add(r)),Object.defineProperty(this,N,{value:void 0,enumerable:!1,writable:!0,configurable:!0})}add(e){let r=this.$refId++;return e[y]!==void 0&&e[y].setParent(this,this[y].root,r),this[y].indexes[r]=r,this.$indexes.set(r,r),this.$items.set(r,e),this[y].change(r),r}at(e){let r=Array.from(this.$items.keys())[e];return this.$items.get(r)}entries(){return this.$items.entries()}delete(e){let r=this.$items.entries(),o,l;for(;(l=r.next())&&!l.done;)if(e===l.value[1]){o=l.value[0];break}return o===void 0?!1:(this.deletedItems[o]=this[y].delete(o),this.$indexes.delete(o),this.$items.delete(o))}clear(){let e=this[y];e.discard(!0),e.indexes={},this.$indexes.clear(),this.$items.clear(),e.operation(t.OPERATION.CLEAR)}has(e){return Array.from(this.$items.values()).some(r=>r===e)}forEach(e){this.$items.forEach((r,o,l)=>e(r,o,this))}values(){return this.$items.values()}get size(){return this.$items.size}[Symbol.iterator](){return this.$items.values()}setIndex(e,r){this.$indexes.set(e,r)}getIndex(e){return this.$indexes.get(e)}[x](e){return this.$items.get(this.$indexes.get(e))}[T](e){let r=this.$indexes.get(e);this.$items.delete(r),this.$indexes.delete(e)}[F](){this.deletedItems={}}toArray(){return Array.from(this.$items.values())}toJSON(){let e=[];return this.forEach((r,o)=>{e.push(typeof r.toJSON=="function"?r.toJSON():r)}),e}clone(e){let r;return e?r=Object.assign(new c,this):(r=new c,this.forEach(o=>{o[y]?r.add(o.clone()):r.add(o)})),r}}return c})();Me("collection",{constructor:An});var ti,ni;let vn=(()=>{class c{static{this[ti]=zt}static{this[ni]=Vt}static[(ti=f,ni=d,u)](e,r,o){return!o||typeof e[N]=="string"||o.visible.has((e[x](r)??e.deletedItems[r])[y])}static is(e){return e.set!==void 0}constructor(e){this.$items=new Map,this.$indexes=new Map,this.deletedItems={},this.$refId=0,this[y]=new ht(this),this[y].indexes={},e&&e.forEach(r=>this.add(r)),Object.defineProperty(this,N,{value:void 0,enumerable:!1,writable:!0,configurable:!0})}add(e){if(this.has(e))return!1;let r=this.$refId++;e[y]!==void 0&&e[y].setParent(this,this[y].root,r);let o=this[y].indexes[r]?.op??t.OPERATION.ADD;return this[y].indexes[r]=r,this.$indexes.set(r,r),this.$items.set(r,e),this[y].change(r,o),r}entries(){return this.$items.entries()}delete(e){let r=this.$items.entries(),o,l;for(;(l=r.next())&&!l.done;)if(e===l.value[1]){o=l.value[0];break}return o===void 0?!1:(this.deletedItems[o]=this[y].delete(o),this.$indexes.delete(o),this.$items.delete(o))}clear(){let e=this[y];e.discard(!0),e.indexes={},this.$indexes.clear(),this.$items.clear(),e.operation(t.OPERATION.CLEAR)}has(e){let r=this.$items.values(),o=!1,l;for(;(l=r.next())&&!l.done;)if(e===l.value){o=!0;break}return o}forEach(e){this.$items.forEach((r,o,l)=>e(r,o,this))}values(){return this.$items.values()}get size(){return this.$items.size}[Symbol.iterator](){return this.$items.values()}setIndex(e,r){this.$indexes.set(e,r)}getIndex(e){return this.$indexes.get(e)}[x](e){return this.$items.get(this.$indexes.get(e))}[T](e){let r=this.$indexes.get(e);this.$items.delete(r),this.$indexes.delete(e)}[F](){this.deletedItems={}}toArray(){return Array.from(this.$items.values())}toJSON(){let e=[];return this.forEach((r,o)=>{e.push(typeof r.toJSON=="function"?r.toJSON():r)}),e}clone(e){let r;return e?r=Object.assign(new c,this):(r=new c,this.forEach(o=>{o[y]?r.add(o.clone()):r.add(o)})),r}}return c})();Me("set",{constructor:vn});function We(c,i,e,r){var o=arguments.length,l=o<3?i:r===null?r=Object.getOwnPropertyDescriptor(i,e):r,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(c,i,e,r);else for(var E=c.length-1;E>=0;E--)(h=c[E])&&(l=(o<3?h(l):o>3?h(i,e,l):h(i,e))||l);return o>3&&l&&Object.defineProperty(i,e,l),l}typeof SuppressedError=="function"&&SuppressedError;class Yo{constructor(i){this.types=i,this.nextUniqueId=0,this.refCount={},this.changeTrees={},this.allChanges=[],this.allFilteredChanges=[],this.changes=[],this.filteredChanges=[]}getNextUniqueId(){return this.nextUniqueId++}add(i){i.ensureRefId();let e=this.changeTrees[i.refId]===void 0;e&&(this.changeTrees[i.refId]=i);let r=this.refCount[i.refId];if(r===0){let o=i.allChanges.operations,l=o.length;for(;l--;)i.indexedOperations[o[l]]=t.OPERATION.ADD,Oe(i.changes,l)}return this.refCount[i.refId]=(r||0)+1,e}remove(i){let e=this.refCount[i.refId]-1;return e<=0?(i.root=void 0,delete this.changeTrees[i.refId],this.removeChangeFromChangeSet("allChanges",i),this.removeChangeFromChangeSet("changes",i),i.filteredChanges&&(this.removeChangeFromChangeSet("allFilteredChanges",i),this.removeChangeFromChangeSet("filteredChanges",i)),this.refCount[i.refId]=0):(this.refCount[i.refId]=e,i.filteredChanges!==void 0?(this.removeChangeFromChangeSet("filteredChanges",i),Ee(this,i,"filteredChanges")):(this.removeChangeFromChangeSet("changes",i),Ee(this,i,"changes"))),i.forEachChild((r,o)=>this.remove(r)),e}removeChangeFromChangeSet(i,e){let r=this[i],o=r.indexOf(e);if(o!==-1)return e[i].queueRootIndex=-1,r[o]=void 0,!0}clear(){this.changes.length=0}}class Ht{static{this.BUFFER_SIZE=typeof Buffer<"u"&&Buffer.poolSize||8*1024}constructor(i){this.sharedBuffer=Buffer.allocUnsafe(Ht.BUFFER_SIZE),this.context=pe.cache(i.constructor),this.root=new Yo(this.context),this.setState(i)}setState(i){this.state=i,this.state[y].setRoot(this.root)}encode(i={offset:0},e,r=this.sharedBuffer,o="changes",l=o==="allChanges",h=i.offset){let E=e!==void 0,b=this.state[y],I=this.root[o];for(let S=0,O=I.length;S<O;S++){let k=I[S];if(!k)continue;if(E)if(e.visible.has(k))e.invisible.delete(k);else{e.invisible.add(k);continue}let M=k[o],R=k.ref,_=M.operations.length;if(_===0)continue;let $=R.constructor,Z=$[f],ne=$[u],He=$[Symbol.metadata];(E||i.offset>h||k!==b)&&(r[i.offset++]=255,he.number(r,k.refId,i));for(let Ie=0;Ie<_;Ie++){let ye=M.operations[Ie],tt=ye<0?Math.abs(ye):l?t.OPERATION.ADD:k.indexedOperations[ye];ye===void 0||tt===void 0||ne&&!ne(R,ye,e)||Z(this,r,k,ye,tt,i,l,E,He)}}if(i.offset>r.byteLength){let S=Math.ceil(i.offset/(Buffer.poolSize??8192))*(Buffer.poolSize??8192);return console.warn(`@colyseus/schema buffer overflow. Encoded state is higher than default BUFFER_SIZE. Use the following to increase default BUFFER_SIZE:

    import { Encoder } from "@colyseus/schema";
    Encoder.BUFFER_SIZE = ${Math.round(S/1024)} * 1024; // ${Math.round(S/1024)} KB
`),r=Buffer.alloc(S,r),r===this.sharedBuffer&&(this.sharedBuffer=r),this.encode({offset:h},e,r,o,l)}else return r.subarray(0,i.offset)}encodeAll(i={offset:0},e=this.sharedBuffer){return this.encode(i,void 0,e,"allChanges",!0)}encodeAllView(i,e,r,o=this.sharedBuffer){let l=r.offset;return this.encode(r,i,o,"allFilteredChanges",!0,l),Buffer.concat([o.subarray(0,e),o.subarray(l,r.offset)])}debugChanges(i){(typeof i=="string"?this.root[i]:i).forEach(r=>{let o=r[i],l=r.ref.constructor[Symbol.metadata];console.log("->",{ref:r.ref.constructor.name,refId:r.refId,changes:Object.keys(o).length});for(let h in o){let E=o[h];console.log("  ->",{index:h,field:l?.[h],op:t.OPERATION[E]})}})}encodeView(i,e,r,o=this.sharedBuffer){let l=r.offset;for(let[h,E]of i.changes){let b=this.root.changeTrees[h];if(b===void 0){i.changes.delete(h);continue}let I=Object.keys(E);if(I.length===0)continue;let O=b.ref.constructor,k=O[f],M=O[Symbol.metadata];o[r.offset++]=255,he.number(o,b.refId,r);for(let R=0,_=I.length;R<_;R++){let $=Number(I[R]),ne=b.ref[x]($)!==void 0&&E[$]||t.OPERATION.DELETE;k(this,o,b,$,ne,r,!1,!0,M)}}return i.changes.clear(),this.encode(r,i,o,"filteredChanges",!1,l),Buffer.concat([o.subarray(0,e),o.subarray(l,r.offset)])}discardChanges(){let i=this.root.changes.length;if(i>0){for(;i--;)this.root.changes[i]?.endEncode("changes");this.root.changes.length=0}if(i=this.root.filteredChanges.length,i>0){for(;i--;)this.root.filteredChanges[i]?.endEncode("filteredChanges");this.root.filteredChanges.length=0}}tryEncodeTypeId(i,e,r,o){let l=this.context.getTypeId(e),h=this.context.getTypeId(r);if(h===void 0){console.warn(`@colyseus/schema WARNING: Class "${r.name}" is not registered on TypeRegistry - Please either tag the class with @entity or define a @type() field.`);return}l!==h&&(i[o.offset++]=213,he.number(i,h,o))}get hasChanges(){return this.root.changes.length>0||this.root.filteredChanges.length>0}}function ri(c,i){if(i===-1||i>=c.length)return!1;let e=c.length-1;for(let r=i;r<e;r++)c[r]=c[r+1];return c.length=e,!0}class ii extends Error{constructor(i){super(i),this.name="DecodingWarning"}}class Go{constructor(){this.refs=new Map,this.refIds=new WeakMap,this.refCounts={},this.deletedRefs=new Set,this.callbacks={},this.nextUniqueId=0}getNextUniqueId(){return this.nextUniqueId++}addRef(i,e,r=!0){this.refs.set(i,e),this.refIds.set(e,i),r&&(this.refCounts[i]=(this.refCounts[i]||0)+1),this.deletedRefs.has(i)&&this.deletedRefs.delete(i)}removeRef(i){let e=this.refCounts[i];if(e===void 0){try{throw new ii("trying to remove refId that doesn't exist: "+i)}catch(r){console.warn(r)}return}if(e===0){try{let r=this.refs.get(i);throw new ii(`trying to remove refId '${i}' with 0 refCount (${r.constructor.name}: ${JSON.stringify(r)})`)}catch(r){console.warn(r)}return}(this.refCounts[i]=e-1)<=0&&this.deletedRefs.add(i)}clearRefs(){this.refs.clear(),this.deletedRefs.clear(),this.callbacks={},this.refCounts={}}garbageCollectDeletedRefs(){this.deletedRefs.forEach(i=>{if(this.refCounts[i]>0)return;let e=this.refs.get(i);if(e.constructor[Symbol.metadata]!==void 0){let r=e.constructor[Symbol.metadata];for(let o in r){let l=r[o].name,h=typeof e[l]=="object"&&this.refIds.get(e[l]);h&&!this.deletedRefs.has(h)&&this.removeRef(h)}}else typeof e[N]=="function"&&Array.from(e.values()).forEach(r=>{let o=this.refIds.get(r);this.deletedRefs.has(o)||this.removeRef(o)});this.refs.delete(i),delete this.refCounts[i],delete this.callbacks[i]}),this.deletedRefs.clear()}addCallback(i,e,r){if(i===void 0){let o=typeof e=="number"?t.OPERATION[e]:e;throw new Error(`Can't addCallback on '${o}' (refId is undefined)`)}return this.callbacks[i]||(this.callbacks[i]={}),this.callbacks[i][e]||(this.callbacks[i][e]=[]),this.callbacks[i][e].push(r),()=>this.removeCallback(i,e,r)}removeCallback(i,e,r){let o=this.callbacks?.[i]?.[e]?.indexOf(r);o!==-1&&ri(this.callbacks[i][e],o)}}class Tn{constructor(i,e){this.currentRefId=0,this.setState(i),this.context=e||new pe(i.constructor)}setState(i){this.state=i,this.root=new Go,this.root.addRef(0,i)}decode(i,e={offset:0},r=this.state){let o=[],l=this.root,h=i.byteLength,E=r.constructor[d];for(this.currentRefId=0;e.offset<h;){if(i[e.offset]==255){e.offset++,this.currentRefId=xe.number(i,e);let I=l.refs.get(this.currentRefId);if(!I)throw new Error(`"refId" not found: ${this.currentRefId}`);r[Q]?.(),r=I,E=r.constructor[d];continue}if(E(this,i,e,r,o)===Ur){console.warn("@colyseus/schema: definition mismatch");let I={offset:e.offset};for(;e.offset<h&&!(i[e.offset]===255&&(I.offset=e.offset+1,l.refs.has(xe.number(i,I))));)e.offset++;continue}}return r[Q]?.(),this.triggerChanges?.(o),l.garbageCollectDeletedRefs(),o}getInstanceType(i,e,r){let o;if(i[e.offset]===213){e.offset++;let l=xe.number(i,e);o=this.context.get(l)}return o||r}createInstanceOfType(i){return new i}removeChildRefs(i,e){let r=typeof i[N]!="string",o=this.root.refIds.get(i);i.forEach((l,h)=>{e.push({ref:i,refId:o,op:t.OPERATION.DELETE,field:h,value:void 0,previousValue:l}),r&&this.root.removeRef(this.root.refIds.get(l))})}}class mt extends ce{}We([ke("string")],mt.prototype,"name",void 0),We([ke("string")],mt.prototype,"type",void 0),We([ke("number")],mt.prototype,"referencedType",void 0);class gt extends ce{constructor(){super(...arguments),this.fields=new qe}}We([ke("number")],gt.prototype,"id",void 0),We([ke("number")],gt.prototype,"extendsId",void 0),We([ke([mt])],gt.prototype,"fields",void 0);class pt extends ce{constructor(){super(...arguments),this.types=new qe}static encode(i,e={offset:0}){let r=i.context,o=new pt,l=new Ht(o),h=r.schemas.get(i.state.constructor);h>0&&(o.rootType=h);let E=new Set,b={},I=O=>{if(O.extendsId===void 0||E.has(O.extendsId)){E.add(O.id),o.types.push(O);let k=b[O.id];k!==void 0&&(delete b[O.id],k.forEach(M=>I(M)))}else b[O.extendsId]===void 0&&(b[O.extendsId]=[]),b[O.extendsId].push(O)};r.schemas.forEach((O,k)=>{let M=new gt;M.id=Number(O);let R=Object.getPrototypeOf(k);R!==ce&&(M.extendsId=r.schemas.get(R));let _=k[Symbol.metadata];if(_!==R[Symbol.metadata])for(let $ in _){let Z=Number($),ne=_[Z].name;if(!Object.prototype.hasOwnProperty.call(_,ne))continue;let He=new mt;He.name=ne;let Ie,ye=_[Z];if(typeof ye.type=="string")Ie=ye.type;else{let tt;ce.is(ye.type)?(Ie="ref",tt=ye.type):(Ie=Object.keys(ye.type)[0],typeof ye.type[Ie]=="string"?Ie+=":"+ye.type[Ie]:tt=ye.type[Ie]),He.referencedType=tt?r.getTypeId(tt):-1}He.type=Ie,M.fields.push(He)}I(M)});for(let O in b)b[O].forEach(k=>o.types.push(k));let S=l.encodeAll(e);return Buffer.from(S,0,e.offset)}static decode(i,e){let r=new pt;new Tn(r).decode(i,e);let l=new pe;r.types.forEach(b=>{let I=l.get(b.extendsId)??ce,S=class extends I{};pe.register(S),l.add(S,b.id)},{});let h=(b,I,S)=>{I.fields.forEach((O,k)=>{let M=S+k;if(O.referencedType!==void 0){let R=O.type,_=l.get(O.referencedType);if(!_){let $=O.type.split(":");R=$[0],_=$[1]}R==="ref"?ue.addField(b,M,O.name,_):ue.addField(b,M,O.name,{[R]:_})}else ue.addField(b,M,O.name,O.type)})};r.types.forEach(b=>{let I=l.get(b.id),S=ue.initialize(I),O=[],k=b;do O.push(k),k=r.types.find(R=>R.id===k.extendsId);while(k);let M=0;O.reverse().forEach(R=>{h(S,R,M),M+=R.fields.length})});let E=new(l.get(r.rootType||0));return new Tn(E,l)}}We([ke([gt])],pt.prototype,"types",void 0),We([ke("number")],pt.prototype,"rootType",void 0);function Zo(c){let i=c.root,e=i.callbacks,r=new WeakMap,o;c.triggerChanges=function(E){let b=new Set;for(let I=0,S=E.length;I<S;I++){let O=E[I],k=O.refId,M=O.ref,R=e[k];if(R){if((O.op&t.OPERATION.DELETE)===t.OPERATION.DELETE&&O.previousValue instanceof ce){let _=e[i.refIds.get(O.previousValue)]?.[t.OPERATION.DELETE];for(let $=_?.length-1;$>=0;$--)_[$]()}if(M instanceof ce){if(!b.has(k)){let _=R?.[t.OPERATION.REPLACE];for(let $=_?.length-1;$>=0;$--)_[$]()}if(R.hasOwnProperty(O.field)){let _=R[O.field];for(let $=_?.length-1;$>=0;$--)_[$](O.value,O.previousValue)}}else{if((O.op&t.OPERATION.DELETE)===t.OPERATION.DELETE){if(O.previousValue!==void 0){let _=R[t.OPERATION.DELETE];for(let $=_?.length-1;$>=0;$--)_[$](O.previousValue,O.dynamicIndex??O.field)}if((O.op&t.OPERATION.ADD)===t.OPERATION.ADD){let _=R[t.OPERATION.ADD];for(let $=_?.length-1;$>=0;$--)_[$](O.value,O.dynamicIndex??O.field)}}else if((O.op&t.OPERATION.ADD)===t.OPERATION.ADD&&O.previousValue===void 0){let _=R[t.OPERATION.ADD];for(let $=_?.length-1;$>=0;$--)_[$](O.value,O.dynamicIndex??O.field)}if(O.value!==O.previousValue&&(O.value!==void 0||O.previousValue!==void 0)){let _=R[t.OPERATION.REPLACE];for(let $=_?.length-1;$>=0;$--)_[$](O.value,O.dynamicIndex??O.field)}}b.add(k)}}};function l(E,b){let I=b.instance?.constructor[Symbol.metadata]||E,S=b.instance&&typeof b.instance.forEach=="function"||E&&typeof E[Symbol.metadata]>"u";if(I&&!S){let O=function(k,M,R,_){return _&&b.instance[M]!==void 0&&!r.has(o)&&R(b.instance[M],void 0),i.addCallback(i.refIds.get(k),M,R)};return new Proxy({listen:function(M,R,_=!0){if(b.instance)return O(b.instance,M,R,_);{let $=()=>{};return b.onInstanceAvailable((Z,ne)=>{$=O(Z,M,R,_&&ne&&!r.has(o))}),()=>$()}},onChange:function(M){return i.addCallback(i.refIds.get(b.instance),t.OPERATION.REPLACE,M)},bindTo:function(M,R){return R||(R=Object.keys(I).map(_=>I[_].name)),i.addCallback(i.refIds.get(b.instance),t.OPERATION.REPLACE,()=>{R.forEach(_=>M[_]=b.instance[_])})}},{get(k,M){let R=I[I[M]];if(R){let _=b.instance?.[M],$=Z=>{let ne=h(b.instance).listen(M,(He,Ie)=>{Z(He,!1),ne?.()},!1);i.refIds.get(_)!==void 0&&Z(_,!0)};return l(R.type,{instance:i.refIds.get(_)&&_,parentInstance:b.instance,onInstanceAvailable:$})}else return k[M]},has(k,M){return I[M]!==void 0},set(k,M,R){throw new Error("not allowed")},deleteProperty(k,M){throw new Error("not allowed")}})}else{let O=function(R,_,$){return $&&R.forEach((Z,ne)=>_(Z,ne)),i.addCallback(i.refIds.get(R),t.OPERATION.ADD,(Z,ne)=>{r.set(_,!0),o=_,_(Z,ne),r.delete(_),o=void 0})},k=function(R,_){return i.addCallback(i.refIds.get(R),t.OPERATION.DELETE,_)},M=function(R,_){return i.addCallback(i.refIds.get(R),t.OPERATION.REPLACE,_)};return new Proxy({onAdd:function(R,_=!0){if(b.instance)return O(b.instance,R,_&&!r.has(o));if(b.onInstanceAvailable){let $=()=>{};return b.onInstanceAvailable((Z,ne)=>{$=O(Z,R,_&&ne&&!r.has(o))}),()=>$()}},onRemove:function(R){if(b.instance)return k(b.instance,R);if(b.onInstanceAvailable){let _=()=>{};return b.onInstanceAvailable($=>{_=k($,R)}),()=>_()}},onChange:function(R){if(b.instance)return M(b.instance,R);if(b.onInstanceAvailable){let _=()=>{};return b.onInstanceAvailable($=>{_=M($,R)}),()=>_()}}},{get(R,_){if(!R[_])throw new Error(`Can't access '${_}' through callback proxy. access the instance directly.`);return R[_]},has(R,_){return R[_]!==void 0},set(R,_,$){throw new Error("not allowed")},deleteProperty(R,_){throw new Error("not allowed")}})}}function h(E){return l(void 0,{instance:E})}return h}function Xo(c,i){c.triggerChanges=i}class Qo{constructor(i=!1){this.iterable=i,this.visible=new WeakSet,this.invisible=new WeakSet,this.changes=new Map,i&&(this.items=[])}add(i,e=Fe,r=!0){let o=i?.[y];if(o){if(!o.parent&&o.refId!==0)throw new Error(`Cannot add a detached instance to the StateView. Make sure to assign the "${o.ref.constructor.name}" instance to the state before calling view.add()`)}else return console.warn("StateView#add(), invalid object:",i),this;let l=i.constructor[Symbol.metadata];this.visible.add(o),this.iterable&&r&&this.items.push(i),r&&o.parent&&this.addParentOf(o,e);let h=this.changes.get(o.refId);if(h===void 0&&(h={},this.changes.set(o.refId,h)),e!==Fe){this.tags||(this.tags=new WeakMap);let E;this.tags.has(o)?E=this.tags.get(o):(E=new Set,this.tags.set(o,E)),E.add(e),l?.[Se]?.[e]?.forEach(b=>{o.getChange(b)!==t.OPERATION.DELETE&&(h[b]=t.OPERATION.ADD)})}else{let E=this.invisible.has(o),b=o.filteredChanges!==void 0?o.allFilteredChanges:o.allChanges;for(let I=0,S=b.operations.length;I<S;I++){let O=b.operations[I];if(O===void 0)continue;let k=o.indexedOperations[O]??t.OPERATION.ADD,M=l?.[O].tag;!o.isNew&&(E||M===void 0||M===e)&&k!==t.OPERATION.DELETE&&(h[O]=k)}}return o.forEachChild((E,b)=>{l&&l[b].tag!==void 0&&l[b].tag!==e||this.add(E.ref,e,!1)}),this}addParentOf(i,e){let r=i.parent[y],o=i.parentIndex;if(!this.visible.has(r)){this.visible.add(r);let l=r.parent?.[y];l&&l.filteredChanges!==void 0&&this.addParentOf(r,e)}if(r.getChange(o)!==t.OPERATION.DELETE){let l=this.changes.get(r.refId);l===void 0&&(l={},this.changes.set(r.refId,l)),this.tags||(this.tags=new WeakMap);let h;this.tags.has(r)?h=this.tags.get(r):(h=new Set,this.tags.set(r,h)),h.add(e),l[o]=t.OPERATION.ADD}}remove(i,e=Fe,r=!1){let o=i[y];if(!o)return console.warn("StateView#remove(), invalid object:",i),this;this.visible.delete(o),this.iterable&&!r&&ri(this.items,this.items.indexOf(i));let h=o.ref.constructor[Symbol.metadata],E=this.changes.get(o.refId);if(E===void 0&&(E={},this.changes.set(o.refId,E)),e===Fe){let b=o.parent;if(ue.isValidInstance(b))h?.[oe].forEach(I=>E[I]=t.OPERATION.DELETE);else{let I=b[y],S=this.changes.get(I.refId);S===void 0&&(S={},this.changes.set(I.refId,S)),S[o.parentIndex]=t.OPERATION.DELETE}}else h?.[Se][e].forEach(b=>E[b]=t.OPERATION.DELETE);if(this.tags&&this.tags.has(o)){let b=this.tags.get(o);e===void 0?this.tags.delete(o):(b.delete(e),b.size===0&&this.tags.delete(o))}return this}has(i){return this.visible.has(i[y])}hasTag(i,e=Fe){return this.tags?.get(i[y])?.has(e)??!1}clear(){if(!this.iterable)throw new Error("StateView#clear() is only available for iterable StateView's. Use StateView(iterable: true) constructor.");for(let i=0,e=this.items.length;i<e;i++)this.remove(this.items[i],Fe,!0);this.items.length=0}}Me("map",{constructor:ut}),Me("array",{constructor:qe}),Me("set",{constructor:vn}),Me("collection",{constructor:An}),t.$changes=y,t.$childType=N,t.$decoder=d,t.$deleteByIndex=T,t.$encoder=f,t.$filter=u,t.$getByIndex=x,t.$track=a,t.ArraySchema=qe,t.ChangeTree=ht,t.CollectionSchema=An,t.Decoder=Tn,t.Encoder=Ht,t.MapSchema=ut,t.Metadata=ue,t.Reflection=pt,t.ReflectionField=mt,t.ReflectionType=gt,t.Schema=ce,t.SetSchema=vn,t.StateView=Qo,t.TypeContext=pe,t.decode=xe,t.decodeKeyValueOperation=Vt,t.decodeSchemaOperation=zr,t.defineCustomTypes=Uo,t.defineTypes=Jo,t.deprecated=Ho,t.dumpChanges=Ko,t.encode=he,t.encodeArray=jr,t.encodeKeyValueOperation=zt,t.encodeSchemaOperation=Fr,t.entity=Wo,t.getDecoderStateCallbacks=Zo,t.getRawChangesCallback=Xo,t.registerType=Me,t.schema=Gr,t.type=ke,t.view=Kr})});var ns=re(ts=>{"use strict";var es=(Kt(),bt(Jt)),st=an(),qn=class{constructor(n){this.events=n,this.isOpen=!1,this.lengthPrefixBuffer=new Uint8Array(9)}connect(n,s={}){let a=s.fingerprint&&{serverCertificateHashes:[{algorithm:"sha-256",value:new Uint8Array(s.fingerprint).buffer}]}||void 0;this.wt=new WebTransport(n,a),this.wt.ready.then(f=>{console.log("WebTransport ready!",f),this.isOpen=!0,this.unreliableReader=this.wt.datagrams.readable.getReader(),this.unreliableWriter=this.wt.datagrams.writable.getWriter(),this.wt.incomingBidirectionalStreams.getReader().read().then(u=>{this.reader=u.value.readable.getReader(),this.writer=u.value.writable.getWriter(),this.sendSeatReservation(s.room.roomId,s.sessionId,s.reconnectionToken),this.readIncomingData(),this.readIncomingUnreliableData()}).catch(u=>{console.error("failed to read incoming stream",u),console.error("TODO: close the connection")})}).catch(f=>{console.log("WebTransport not ready!",f),this._close()}),this.wt.closed.then(f=>{console.log("WebTransport closed w/ success",f),this.events.onclose({code:f.closeCode,reason:f.reason})}).catch(f=>{console.log("WebTransport closed w/ error",f),this.events.onerror(f),this.events.onclose({code:f.closeCode,reason:f.reason})}).finally(()=>{this._close()})}send(n){let s=st.encode.number(this.lengthPrefixBuffer,n.length,{offset:0}),a=new Uint8Array(s+n.length);a.set(this.lengthPrefixBuffer.subarray(0,s),0),a.set(n,s),this.writer.write(a)}sendUnreliable(n){let s=st.encode.number(this.lengthPrefixBuffer,n.length,{offset:0}),a=new Uint8Array(s+n.length);a.set(this.lengthPrefixBuffer.subarray(0,s),0),a.set(n,s),this.unreliableWriter.write(a)}close(n,s){try{this.wt.close({closeCode:n,reason:s})}catch(a){console.error(a)}}readIncomingData(){return es.__awaiter(this,void 0,void 0,function*(){let n;for(;this.isOpen;){try{n=yield this.reader.read();let s=n.value,a={offset:0};do{let f=st.decode.number(s,a);this.events.onmessage({data:s.subarray(a.offset,a.offset+f)}),a.offset+=f}while(a.offset<s.length)}catch(s){s.message.indexOf("session is closed")===-1&&console.error("H3Transport: failed to read incoming data",s);break}if(n.done)break}})}readIncomingUnreliableData(){return es.__awaiter(this,void 0,void 0,function*(){let n;for(;this.isOpen;){try{n=yield this.unreliableReader.read();let s=n.value,a={offset:0};do{let f=st.decode.number(s,a);this.events.onmessage({data:s.subarray(a.offset,a.offset+f)}),a.offset+=f}while(a.offset<s.length)}catch(s){s.message.indexOf("session is closed")===-1&&console.error("H3Transport: failed to read incoming data",s);break}if(n.done)break}})}sendSeatReservation(n,s,a){let f={offset:0},d=[];st.encode.string(d,n,f),st.encode.string(d,s,f),a&&st.encode.string(d,a,f),this.writer.write(new Uint8Array(d).buffer)}_close(){this.isOpen=!1}};ts.H3TransportTransport=qn});var is=re((Pc,rs)=>{"use strict";rs.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}});var os=re(ss=>{"use strict";var ua=is(),Wn=globalThis.WebSocket||ua,Hn=class{constructor(n){this.events=n}send(n){this.ws.send(n)}sendUnreliable(n){console.warn("colyseus.js: The WebSocket transport does not support unreliable messages")}connect(n,s){try{this.ws=new Wn(n,{headers:s,protocols:this.protocols})}catch{this.ws=new Wn(n,this.protocols)}this.ws.binaryType="arraybuffer",this.ws.onopen=this.events.onopen,this.ws.onmessage=this.events.onmessage,this.ws.onclose=this.events.onclose,this.ws.onerror=this.events.onerror}close(n,s){this.ws.close(n,s)}get isOpen(){return this.ws.readyState===Wn.OPEN}};ss.WebSocketTransport=Hn});var cs=re(as=>{"use strict";var ma=ns(),ga=os(),Jn=class{constructor(n){switch(this.events={},n){case"h3":this.transport=new ma.H3TransportTransport(this.events);break;default:this.transport=new ga.WebSocketTransport(this.events);break}}connect(n,s){this.transport.connect.call(this.transport,n,s)}send(n){this.transport.send(n)}sendUnreliable(n){this.transport.sendUnreliable(n)}close(n,s){this.transport.close(n,s)}get isOpen(){return this.transport.isOpen}};as.Connection=Jn});var Kn=re(ot=>{"use strict";ot.Protocol=void 0;(function(t){t[t.HANDSHAKE=9]="HANDSHAKE",t[t.JOIN_ROOM=10]="JOIN_ROOM",t[t.ERROR=11]="ERROR",t[t.LEAVE_ROOM=12]="LEAVE_ROOM",t[t.ROOM_DATA=13]="ROOM_DATA",t[t.ROOM_STATE=14]="ROOM_STATE",t[t.ROOM_STATE_PATCH=15]="ROOM_STATE_PATCH",t[t.ROOM_DATA_SCHEMA=16]="ROOM_DATA_SCHEMA",t[t.ROOM_DATA_BYTES=17]="ROOM_DATA_BYTES"})(ot.Protocol||(ot.Protocol={}));ot.ErrorCode=void 0;(function(t){t[t.MATCHMAKE_NO_HANDLER=4210]="MATCHMAKE_NO_HANDLER",t[t.MATCHMAKE_INVALID_CRITERIA=4211]="MATCHMAKE_INVALID_CRITERIA",t[t.MATCHMAKE_INVALID_ROOM_ID=4212]="MATCHMAKE_INVALID_ROOM_ID",t[t.MATCHMAKE_UNHANDLED=4213]="MATCHMAKE_UNHANDLED",t[t.MATCHMAKE_EXPIRED=4214]="MATCHMAKE_EXPIRED",t[t.AUTH_FAILED=4215]="AUTH_FAILED",t[t.APPLICATION_ERROR=4216]="APPLICATION_ERROR"})(ot.ErrorCode||(ot.ErrorCode={}))});var Gn=re(Yn=>{"use strict";var fs={};function pa(t,n){fs[t]=n}function ya(t){let n=fs[t];if(!n)throw new Error("missing serializer: "+t);return n}Yn.getSerializer=ya;Yn.registerSerializer=pa});var Zn=re(ls=>{"use strict";var ba=()=>({emit(t,...n){let s=this.events[t]||[];for(let a=0,f=s.length;a<f;a++)s[a](...n)},events:{},on(t,n){var s;return!((s=this.events[t])===null||s===void 0)&&s.push(n)||(this.events[t]=[n]),()=>{var a;this.events[t]=(a=this.events[t])===null||a===void 0?void 0:a.filter(f=>n!==f)}}});ls.createNanoEvents=ba});var ds=re(Xn=>{"use strict";var cn=class{constructor(){this.handlers=[]}register(n,s=!1){return this.handlers.push(n),this}invoke(...n){this.handlers.forEach(s=>s.apply(this,n))}invokeAsync(...n){return Promise.all(this.handlers.map(s=>s.apply(this,n)))}remove(n){let s=this.handlers.indexOf(n);this.handlers[s]=this.handlers[this.handlers.length-1],this.handlers.pop()}clear(){this.handlers=[]}};function wa(){let t=new cn;function n(s){return t.register(s,this===null)}return n.once=s=>{let a=function(...f){s.apply(this,f),t.remove(a)};t.register(a)},n.remove=s=>t.remove(s),n.invoke=(...s)=>t.invoke(...s),n.invokeAsync=(...s)=>t.invokeAsync(...s),n.clear=()=>t.clear(),n}Xn.EventEmitter=cn;Xn.createSignal=wa});var tr=re(er=>{"use strict";var fn=an();function Ea(t){try{return fn.getDecoderStateCallbacks(t.serializer.decoder)}catch{return}}var Qn=class{setState(n,s){this.decoder.decode(n,s)}getState(){return this.state}patch(n,s){return this.decoder.decode(n,s)}teardown(){this.decoder.root.clearRefs()}handshake(n,s){this.state?(fn.Reflection.decode(n,s),this.decoder=new fn.Decoder(this.state)):(this.decoder=fn.Reflection.decode(n,s),this.state=this.decoder.state)}};er.SchemaSerializer=Qn;er.getStateCallbacks=Ea});function ln(t){try{if(!Y.trusted&&!Ge){let s=z.sharedLength||0;s<z.length&&(z.length=s)}let n;if(Y.randomAccessStructure&&D[m]<64&&D[m]>=32&&us?(n=us(D,m,_e,Y),D=null,!(t&&t.lazy)&&n&&(n=n.toJSON()),m=_e):n=se(),le&&(m=le.postBundlePosition,le=null),Ge&&(z.restoreStructures=null),m==_e)z&&z.restoreStructures&&ps(),z=null,D=null,Ue&&(Ue=null);else{if(m>_e)throw new Error("Unexpected end of MessagePack data");if(!Ge){let s;try{s=JSON.stringify(n,(a,f)=>typeof f=="bigint"?`${f}n`:f).slice(0,100)}catch(a){s="(JSON view not available "+a+")"}throw new Error("Data read, but end of buffer not reached "+s)}}return n}catch(n){throw z&&z.restoreStructures&&ps(),Dt(),(n instanceof RangeError||n.message.startsWith("Unexpected end of buffer")||m>_e)&&(n.incomplete=!0),n}}function ps(){for(let t in z.restoreStructures)z[t]=z.restoreStructures[t];z.restoreStructures=null}function se(){let t=D[m++];if(t<160)if(t<128){if(t<64)return t;{let n=z[t&63]||Y.getStructures&&vs()[t&63];return n?(n.read||(n.read=ar(n,t&63)),n.read()):t}}else if(t<144)if(t-=128,Y.mapsAsObjects){let n={};for(let s=0;s<t;s++){let a=Cs();a==="__proto__"&&(a="__proto_"),n[a]=se()}return n}else{let n=new Map;for(let s=0;s<t;s++)n.set(se(),se());return n}else{t-=144;let n=new Array(t);for(let s=0;s<t;s++)n[s]=se();return Y.freezeData?Object.freeze(n):n}else if(t<192){let n=t-160;if(Le>=m)return Ye.slice(m-Te,(m+=n)-Te);if(Le==0&&_e<140){let s=n<16?cr(n):_s(n);if(s!=null)return s}return or(n)}else{let n;switch(t){case 192:return null;case 193:return le?(n=se(),n>0?le[1].slice(le.position1,le.position1+=n):le[0].slice(le.position0,le.position0-=n)):dn;case 194:return!1;case 195:return!0;case 196:if(n=D[m++],n===void 0)throw new Error("Unexpected end of buffer");return nr(n);case 197:return n=j.getUint16(m),m+=2,nr(n);case 198:return n=j.getUint32(m),m+=4,nr(n);case 199:return at(D[m++]);case 200:return n=j.getUint16(m),m+=2,at(n);case 201:return n=j.getUint32(m),m+=4,at(n);case 202:if(n=j.getFloat32(m),Y.useFloat32>2){let s=$t[(D[m]&127)<<1|D[m+1]>>7];return m+=4,(s*n+(n>0?.5:-.5)>>0)/s}return m+=4,n;case 203:return n=j.getFloat64(m),m+=8,n;case 204:return D[m++];case 205:return n=j.getUint16(m),m+=2,n;case 206:return n=j.getUint32(m),m+=4,n;case 207:return Y.int64AsType==="number"?(n=j.getUint32(m)*4294967296,n+=j.getUint32(m+4)):Y.int64AsType==="string"?n=j.getBigUint64(m).toString():Y.int64AsType==="auto"?(n=j.getBigUint64(m),n<=BigInt(2)<<BigInt(52)&&(n=Number(n))):n=j.getBigUint64(m),m+=8,n;case 208:return j.getInt8(m++);case 209:return n=j.getInt16(m),m+=2,n;case 210:return n=j.getInt32(m),m+=4,n;case 211:return Y.int64AsType==="number"?(n=j.getInt32(m)*4294967296,n+=j.getUint32(m+4)):Y.int64AsType==="string"?n=j.getBigInt64(m).toString():Y.int64AsType==="auto"?(n=j.getBigInt64(m),n>=BigInt(-2)<<BigInt(52)&&n<=BigInt(2)<<BigInt(52)&&(n=Number(n))):n=j.getBigInt64(m),m+=8,n;case 212:if(n=D[m++],n==114)return Os(D[m++]&63);{let s=me[n];if(s)return s.read?(m++,s.read(se())):s.noBuffer?(m++,s()):s(D.subarray(m,++m));throw new Error("Unknown extension "+n)}case 213:return n=D[m],n==114?(m++,Os(D[m++]&63,D[m++])):at(2);case 214:return at(4);case 215:return at(8);case 216:return at(16);case 217:return n=D[m++],Le>=m?Ye.slice(m-Te,(m+=n)-Te):Oa(n);case 218:return n=j.getUint16(m),m+=2,Le>=m?Ye.slice(m-Te,(m+=n)-Te):Ia(n);case 219:return n=j.getUint32(m),m+=4,Le>=m?Ye.slice(m-Te,(m+=n)-Te):Sa(n);case 220:return n=j.getUint16(m),m+=2,bs(n);case 221:return n=j.getUint32(m),m+=4,bs(n);case 222:return n=j.getUint16(m),m+=2,ws(n);case 223:return n=j.getUint32(m),m+=4,ws(n);default:if(t>=224)return t-256;if(t===void 0){let s=new Error("Unexpected end of MessagePack data");throw s.incomplete=!0,s}throw new Error("Unknown MessagePack token "+t)}}}function ar(t,n){function s(){if(s.count++>As){let f=t.read=new Function("r","return function(){return "+(Y.freezeData?"Object.freeze":"")+"({"+t.map(d=>d==="__proto__"?"__proto_:r()":xa.test(d)?d+":r()":"["+JSON.stringify(d)+"]:r()").join(",")+"})}")(se);return t.highByte===0&&(t.read=ys(n,t.read)),f()}let a={};for(let f=0,d=t.length;f<d;f++){let u=t[f];u==="__proto__"&&(u="__proto_"),a[u]=se()}return Y.freezeData?Object.freeze(a):a}return s.count=0,t.highByte===0?ys(n,s):s}function vs(){let t=Ps(()=>(D=null,Y.getStructures()));return z=Y._mergeStructures(t,z)}function kt(t){let n;if(t<16&&(n=cr(t)))return n;if(t>64&&rr)return rr.decode(D.subarray(m,m+=t));let s=m+t,a=[];for(n="";m<s;){let f=D[m++];if(!(f&128))a.push(f);else if((f&224)===192){let d=D[m++]&63;a.push((f&31)<<6|d)}else if((f&240)===224){let d=D[m++]&63,u=D[m++]&63;a.push((f&31)<<12|d<<6|u)}else if((f&248)===240){let d=D[m++]&63,u=D[m++]&63,x=D[m++]&63,T=(f&7)<<18|d<<12|u<<6|x;T>65535&&(T-=65536,a.push(T>>>10&1023|55296),T=56320|T&1023),a.push(T)}else a.push(f);a.length>=4096&&(n+=fe.apply(String,a),a.length=0)}return a.length>0&&(n+=fe.apply(String,a)),n}function bs(t){let n=new Array(t);for(let s=0;s<t;s++)n[s]=se();return Y.freezeData?Object.freeze(n):n}function ws(t){if(Y.mapsAsObjects){let n={};for(let s=0;s<t;s++){let a=Cs();a==="__proto__"&&(a="__proto_"),n[a]=se()}return n}else{let n=new Map;for(let s=0;s<t;s++)n.set(se(),se());return n}}function _s(t){let n=m,s=new Array(t);for(let a=0;a<t;a++){let f=D[m++];if((f&128)>0){m=n;return}s[a]=f}return fe.apply(String,s)}function cr(t){if(t<4)if(t<2){if(t===0)return"";{let n=D[m++];if((n&128)>1){m-=1;return}return fe(n)}}else{let n=D[m++],s=D[m++];if((n&128)>0||(s&128)>0){m-=2;return}if(t<3)return fe(n,s);let a=D[m++];if((a&128)>0){m-=3;return}return fe(n,s,a)}else{let n=D[m++],s=D[m++],a=D[m++],f=D[m++];if((n&128)>0||(s&128)>0||(a&128)>0||(f&128)>0){m-=4;return}if(t<6){if(t===4)return fe(n,s,a,f);{let d=D[m++];if((d&128)>0){m-=5;return}return fe(n,s,a,f,d)}}else if(t<8){let d=D[m++],u=D[m++];if((d&128)>0||(u&128)>0){m-=6;return}if(t<7)return fe(n,s,a,f,d,u);let x=D[m++];if((x&128)>0){m-=7;return}return fe(n,s,a,f,d,u,x)}else{let d=D[m++],u=D[m++],x=D[m++],T=D[m++];if((d&128)>0||(u&128)>0||(x&128)>0||(T&128)>0){m-=8;return}if(t<10){if(t===8)return fe(n,s,a,f,d,u,x,T);{let y=D[m++];if((y&128)>0){m-=9;return}return fe(n,s,a,f,d,u,x,T,y)}}else if(t<12){let y=D[m++],N=D[m++];if((y&128)>0||(N&128)>0){m-=10;return}if(t<11)return fe(n,s,a,f,d,u,x,T,y,N);let F=D[m++];if((F&128)>0){m-=11;return}return fe(n,s,a,f,d,u,x,T,y,N,F)}else{let y=D[m++],N=D[m++],F=D[m++],Q=D[m++];if((y&128)>0||(N&128)>0||(F&128)>0||(Q&128)>0){m-=12;return}if(t<14){if(t===12)return fe(n,s,a,f,d,u,x,T,y,N,F,Q);{let H=D[m++];if((H&128)>0){m-=13;return}return fe(n,s,a,f,d,u,x,T,y,N,F,Q,H)}}else{let H=D[m++],ee=D[m++];if((H&128)>0||(ee&128)>0){m-=14;return}if(t<15)return fe(n,s,a,f,d,u,x,T,y,N,F,Q,H,ee);let te=D[m++];if((te&128)>0){m-=15;return}return fe(n,s,a,f,d,u,x,T,y,N,F,Q,H,ee,te)}}}}}function Es(){let t=D[m++],n;if(t<192)n=t-160;else switch(t){case 217:n=D[m++];break;case 218:n=j.getUint16(m),m+=2;break;case 219:n=j.getUint32(m),m+=4;break;default:throw new Error("Expected string")}return kt(n)}function nr(t){return Y.copyBuffers?Uint8Array.prototype.slice.call(D,m,m+=t):D.subarray(m,m+=t)}function at(t){let n=D[m++];if(me[n]){let s;return me[n](D.subarray(m,s=m+=t),a=>{m=a;try{return se()}finally{m=s}})}else throw new Error("Unknown extension type "+n)}function Cs(){let t=D[m++];if(t>=160&&t<192){if(t=t-160,Le>=m)return Ye.slice(m-Te,(m+=t)-Te);if(!(Le==0&&_e<180))return or(t)}else return m--,Rs(se());let n=(t<<5^(t>1?j.getUint16(m):t>0?D[m]:0))&4095,s=xs[n],a=m,f=m+t-3,d,u=0;if(s&&s.bytes==t){for(;a<f;){if(d=j.getUint32(a),d!=s[u++]){a=1879048192;break}a+=4}for(f+=3;a<f;)if(d=D[a++],d!=s[u++]){a=1879048192;break}if(a===f)return m=a,s.string;f-=3,a=m}for(s=[],xs[n]=s,s.bytes=t;a<f;)d=j.getUint32(a),s.push(d),a+=4;for(f+=3;a<f;)d=D[a++],s.push(d);let x=t<16?cr(t):_s(t);return x!=null?s.string=x:s.string=or(t)}function Rs(t){if(typeof t=="string")return t;if(typeof t=="number"||typeof t=="boolean"||typeof t=="bigint")return t.toString();if(t==null)return t+"";if(Y.allowArraysInMapKeys&&Array.isArray(t)&&t.flat().every(n=>["string","number","boolean","bigint"].includes(typeof n)))return t.flat().toString();throw new Error(`Invalid property type for record: ${typeof t}`)}function Ps(t){gs&&gs();let n=_e,s=m,a=sr,f=Te,d=Le,u=Ye,x=ir,T=Ue,y=le,N=new Uint8Array(D.slice(0,_e)),F=z,Q=z.slice(0,z.length),H=Y,ee=Ge,te=t();return _e=n,m=s,sr=a,Te=f,Le=d,Ye=u,ir=x,Ue=T,le=y,D=N,Ge=ee,z=F,z.splice(0,z.length,...Q),Y=H,j=new DataView(D.buffer,D.byteOffset,D.byteLength),te}function Dt(){D=null,Ue=null,z=null}function Ds(t){t.unpack?me[t.type]=t.unpack:me[t.type]=t}function Bs(t){Ls[0]=t;let n=$t[(Is[3]&127)<<1|Is[2]>>7];return(n*t+(t>0?.5:-.5)>>0)/n}var rr,D,_e,m,Ss,ir,sr,Y,z,Ye,Te,Le,le,Ue,me,j,hs,Pt,dn,Ge,As,us,ms,gs,Be,xa,ys,or,Oa,Ia,Sa,Ts,fe,xs,Os,Aa,fr,va,Ta,$t,ks,hn,$s,Ns,Ms,Nt,Ls,Is,xt=Tt(()=>{"use strict";try{rr=new TextDecoder}catch{}m=0,Ss=[],ir=Ss,sr=0,Y={},Te=0,Le=0,me=[],hs={useRecords:!1,mapsAsObjects:!0},Pt=class{},dn=new Pt;dn.name="MessagePack 0xC1";Ge=!1,As=2;try{new Function("")}catch{As=1/0}Be=class t{constructor(n){n&&(n.useRecords===!1&&n.mapsAsObjects===void 0&&(n.mapsAsObjects=!0),n.sequential&&n.trusted!==!1&&(n.trusted=!0,!n.structures&&n.useRecords!=!1&&(n.structures=[],n.maxSharedStructures||(n.maxSharedStructures=0))),n.structures?n.structures.sharedLength=n.structures.length:n.getStructures&&((n.structures=[]).uninitialized=!0,n.structures.sharedLength=0),n.int64AsNumber&&(n.int64AsType="number")),Object.assign(this,n)}unpack(n,s){if(D)return Ps(()=>(Dt(),this?this.unpack(n,s):t.prototype.unpack.call(hs,n,s)));!n.buffer&&n.constructor===ArrayBuffer&&(n=typeof Buffer<"u"?Buffer.from(n):new Uint8Array(n)),typeof s=="object"?(_e=s.end||n.length,m=s.start||0):(m=0,_e=s>-1?s:n.length),sr=0,Le=0,Ye=null,ir=Ss,le=null,D=n;try{j=n.dataView||(n.dataView=new DataView(n.buffer,n.byteOffset,n.byteLength))}catch(a){throw D=null,n instanceof Uint8Array?a:new Error("Source must be a Uint8Array or Buffer but was a "+(n&&typeof n=="object"?n.constructor.name:typeof n))}if(this instanceof t){if(Y=this,this.structures)return z=this.structures,ln(s);(!z||z.length>0)&&(z=[])}else Y=hs,(!z||z.length>0)&&(z=[]);return ln(s)}unpackMultiple(n,s){let a,f=0;try{Ge=!0;let d=n.length,u=this?this.unpack(n,d):hn.unpack(n,d);if(s){if(s(u,f,m)===!1)return;for(;m<d;)if(f=m,s(ln(),f,m)===!1)return}else{for(a=[u];m<d;)f=m,a.push(ln());return a}}catch(d){throw d.lastPosition=f,d.values=a,d}finally{Ge=!1,Dt()}}_mergeStructures(n,s){ms&&(n=ms.call(this,n)),n=n||[],Object.isFrozen(n)&&(n=n.map(a=>a.slice(0)));for(let a=0,f=n.length;a<f;a++){let d=n[a];d&&(d.isShared=!0,a>=32&&(d.highByte=a-32>>5))}n.sharedLength=n.length;for(let a in s||[])if(a>=0){let f=n[a],d=s[a];d&&(f&&((n.restoreStructures||(n.restoreStructures=[]))[a]=f),n[a]=d)}return this.structures=n}decode(n,s){return this.unpack(n,s)}};xa=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;ys=(t,n)=>function(){let s=D[m++];if(s===0)return n();let a=t<32?-(t+(s<<5)):t+(s<<5),f=z[a]||vs()[a];if(!f)throw new Error("Record id is not defined for "+a);return f.read||(f.read=ar(f,t)),f.read()};or=kt,Oa=kt,Ia=kt,Sa=kt,Ts=!1;fe=String.fromCharCode;xs=new Array(4096);Os=(t,n)=>{let s=se().map(Rs),a=t;n!==void 0&&(t=t<32?-((n<<5)+t):(n<<5)+t,s.highByte=n);let f=z[t];return f&&(f.isShared||Ge)&&((z.restoreStructures||(z.restoreStructures=[]))[t]=f),z[t]=s,s.read=ar(s,a),s.read()};me[0]=()=>{};me[0].noBuffer=!0;me[66]=t=>{let n=t.length,s=BigInt(t[0]&128?t[0]-256:t[0]);for(let a=1;a<n;a++)s<<=BigInt(8),s+=BigInt(t[a]);return s};Aa={Error,TypeError,ReferenceError};me[101]=()=>{let t=se();return(Aa[t[0]]||Error)(t[1],{cause:t[2]})};me[105]=t=>{if(Y.structuredClone===!1)throw new Error("Structured clone extension is disabled");let n=j.getUint32(m-4);Ue||(Ue=new Map);let s=D[m],a;s>=144&&s<160||s==220||s==221?a=[]:a={};let f={target:a};Ue.set(n,f);let d=se();return f.used?Object.assign(a,d):(f.target=d,d)};me[112]=t=>{if(Y.structuredClone===!1)throw new Error("Structured clone extension is disabled");let n=j.getUint32(m-4),s=Ue.get(n);return s.used=!0,s.target};me[115]=()=>new Set(se());fr=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(t=>t+"Array"),va=typeof globalThis=="object"?globalThis:window;me[116]=t=>{let n=t[0],s=fr[n];if(!s){if(n===16){let a=new ArrayBuffer(t.length-1);return new Uint8Array(a).set(t.subarray(1)),a}throw new Error("Could not find typed array for code "+n)}return new va[s](Uint8Array.prototype.slice.call(t,1).buffer)};me[120]=()=>{let t=se();return new RegExp(t[0],t[1])};Ta=[];me[98]=t=>{let n=(t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3],s=m;return m+=n-t.length,le=Ta,le=[Es(),Es()],le.position0=0,le.position1=0,le.postBundlePosition=m,m=s,se()};me[255]=t=>t.length==4?new Date((t[0]*16777216+(t[1]<<16)+(t[2]<<8)+t[3])*1e3):t.length==8?new Date(((t[0]<<22)+(t[1]<<14)+(t[2]<<6)+(t[3]>>2))/1e6+((t[3]&3)*4294967296+t[4]*16777216+(t[5]<<16)+(t[6]<<8)+t[7])*1e3):t.length==12?new Date(((t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3])/1e6+((t[4]&128?-281474976710656:0)+t[6]*1099511627776+t[7]*4294967296+t[8]*16777216+(t[9]<<16)+(t[10]<<8)+t[11])*1e3):new Date("invalid");$t=new Array(147);for(let t=0;t<256;t++)$t[t]=+("1e"+Math.floor(45.15-t*.30103));ks=Be,hn=new Be({useRecords:!1}),$s=hn.unpack,Ns=hn.unpackMultiple,Ms=hn.unpack,Nt={NEVER:0,ALWAYS:1,DECIMAL_ROUND:3,DECIMAL_FIT:4},Ls=new Float32Array(1),Is=new Uint8Array(Ls.buffer,0,4)});function js(t,n,s,a){let f=t.byteLength;if(f+1<256){var{target:d,position:u}=s(4+f);d[u++]=199,d[u++]=f+1}else if(f+1<65536){var{target:d,position:u}=s(5+f);d[u++]=200,d[u++]=f+1>>8,d[u++]=f+1&255}else{var{target:d,position:u,targetView:x}=s(7+f);d[u++]=201,x.setUint32(u,f+1),u+=4}d[u++]=116,d[u++]=n,t.buffer||(t=new Uint8Array(t)),d.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),u)}function Us(t,n){let s=t.byteLength;var a,f;if(s<256){var{target:a,position:f}=n(s+2);a[f++]=196,a[f++]=s}else if(s<65536){var{target:a,position:f}=n(s+3);a[f++]=197,a[f++]=s>>8,a[f++]=s&255}else{var{target:a,position:f,targetView:d}=n(s+5);a[f++]=198,d.setUint32(f,s),f+=4}a.set(t,f)}function Pa(t,n,s,a){let f=t.length;switch(f){case 1:n[s++]=212;break;case 2:n[s++]=213;break;case 4:n[s++]=214;break;case 8:n[s++]=215;break;case 16:n[s++]=216;break;default:f<256?(n[s++]=199,n[s++]=f):f<65536?(n[s++]=200,n[s++]=f>>8,n[s++]=f&255):(n[s++]=201,n[s++]=f>>24,n[s++]=f>>16&255,n[s++]=f>>8&255,n[s++]=f&255)}return n[s++]=a,n.set(t,s),s+=f,s}function Da(t,n){let s,a=n.length*6,f=t.length-a;for(;s=n.pop();){let d=s.offset,u=s.id;t.copyWithin(d+a,d,f),a-=6;let x=d+a;t[x++]=214,t[x++]=105,t[x++]=u>>24,t[x++]=u>>16&255,t[x++]=u>>8&255,t[x++]=u&255,f=d}return t}function zs(t,n,s){if(ie.length>0){X.setUint32(ie.position+t,g+s-ie.position-t),ie.stringsPosition=g-t;let a=ie;ie=null,n(a[0]),n(a[1])}}function qs(t){if(t.Class){if(!t.pack&&!t.write)throw new Error("Extension has no pack or write function");if(t.pack&&!t.type)throw new Error("Extension has no type (numeric code to identify the extension)");lr.unshift(t.Class),gn.unshift(t)}Ds(t)}function ka(t,n){return t.isCompatible=s=>{let a=!s||(n.lastNamedStructuresLength||0)===s.length;return a||n._mergeStructures(s),a},t}var mn,gn,lr,pn,un,Vs,Fs,p,Mt,X,g,we,ie,_a,Ca,Ra,Ot,ze,Ws,Hs,Js,Ks,Ys,Gs,Zs,Xs,dr,hr,ur,mr=Tt(()=>{"use strict";xt();xt();xt();try{mn=new TextEncoder}catch{}pn=typeof Buffer<"u",un=pn?function(t){return Buffer.allocUnsafeSlow(t)}:Uint8Array,Vs=pn?Buffer:Uint8Array,Fs=pn?4294967296:2144337920,g=0,ie=null,Ca=21760,Ra=/[\u0080-\uFFFF]/,Ot=Symbol("record-id"),ze=class extends Be{constructor(n){super(n),this.offset=0;let s,a,f,d,u,x=Vs.prototype.utf8Write?function(w,C){return p.utf8Write(w,C,p.byteLength-C)}:mn&&mn.encodeInto?function(w,C){return mn.encodeInto(w,p.subarray(C)).written}:!1,T=this;n||(n={});let y=n&&n.sequential,N=n.structures||n.saveStructures,F=n.maxSharedStructures;if(F==null&&(F=N?32:0),F>8160)throw new Error("Maximum maxSharedStructure is 8160");n.structuredClone&&n.moreTypes==null&&(this.moreTypes=!0);let Q=n.maxOwnStructures;Q==null&&(Q=N?32:64),!this.structures&&n.useRecords!=!1&&(this.structures=[]);let H=F>32||Q+F>64,ee=F+64,te=F+Q+64;if(te>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let oe=[],Se=0,ft=0;this.pack=this.encode=function(w,C){if(p||(p=new un(8192),X=p.dataView||(p.dataView=new DataView(p.buffer,0,8192)),g=0),we=p.length-10,we-g<2048?(p=new un(p.length),X=p.dataView||(p.dataView=new DataView(p.buffer,0,p.length)),we=p.length-10,g=0):g=g+7&2147483640,a=g,C&ur&&(g+=C&255),u=T.structuredClone?new Map:null,T.bundleStrings&&typeof w!="string"?(ie=[],ie.size=1/0):ie=null,d=T.structures,d){d.uninitialized&&(d=T._mergeStructures(T.getStructures()));let A=d.sharedLength||0;if(A>F)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+d.sharedLength);if(!d.transitions){d.transitions=Object.create(null);for(let P=0;P<A;P++){let L=d[P];if(!L)continue;let U,B=d.transitions;for(let V=0,q=L.length;V<q;V++){let Ae=L[V];U=B[Ae],U||(U=B[Ae]=Object.create(null)),B=U}B[Ot]=P+64}this.lastNamedStructuresLength=A}y||(d.nextId=A+64)}f&&(f=!1);let v;try{T.randomAccessStructure&&w&&w.constructor&&w.constructor===Object?Ft(w):G(w);let A=ie;if(ie&&zs(a,G,0),u&&u.idsToInsert){let P=u.idsToInsert.sort((V,q)=>V.offset>q.offset?1:-1),L=P.length,U=-1;for(;A&&L>0;){let V=P[--L].offset+a;V<A.stringsPosition+a&&U===-1&&(U=0),V>A.position+a?U>=0&&(U+=6):(U>=0&&(X.setUint32(A.position+a,X.getUint32(A.position+a)+U),U=-1),A=A.previous,L++)}U>=0&&A&&X.setUint32(A.position+a,X.getUint32(A.position+a)+U),g+=P.length*6,g>we&&Pe(g),T.offset=g;let B=Da(p.subarray(a,g),P);return u=null,B}return T.offset=g,C&dr?(p.start=a,p.end=g,p):p.subarray(a,g)}catch(A){throw v=A,A}finally{if(d&&(Xe(),f&&T.saveStructures)){let A=d.sharedLength||0,P=p.subarray(a,g),L=ka(d,T);if(!v)return T.saveStructures(L,L.isCompatible)===!1?T.pack(w,C):(T.lastNamedStructuresLength=A,p.length>1073741824&&(p=null),P)}p.length>1073741824&&(p=null),C&hr&&(g=a)}};let Xe=()=>{ft<10&&ft++;let w=d.sharedLength||0;if(d.length>w&&!y&&(d.length=w),Se>1e4)d.transitions=null,ft=0,Se=0,oe.length>0&&(oe=[]);else if(oe.length>0&&!y){for(let C=0,v=oe.length;C<v;C++)oe[C][Ot]=0;oe=[]}},Re=w=>{var C=w.length;C<16?p[g++]=144|C:C<65536?(p[g++]=220,p[g++]=C>>8,p[g++]=C&255):(p[g++]=221,X.setUint32(g,C),g+=4);for(let v=0;v<C;v++)G(w[v])},G=w=>{g>we&&(p=Pe(g));var C=typeof w,v;if(C==="string"){let A=w.length;if(ie&&A>=4&&A<4096){if((ie.size+=A)>Ca){let B,V=(ie[0]?ie[0].length*3+ie[1].length:0)+10;g+V>we&&(p=Pe(g+V));let q;ie.position?(q=ie,p[g]=200,g+=3,p[g++]=98,B=g-a,g+=4,zs(a,G,0),X.setUint16(B+a-3,g-a-B)):(p[g++]=214,p[g++]=98,B=g-a,g+=4),ie=["",""],ie.previous=q,ie.size=0,ie.position=B}let U=Ra.test(w);ie[U?0:1]+=w,p[g++]=193,G(U?-A:A);return}let P;A<32?P=1:A<256?P=2:A<65536?P=3:P=5;let L=A*3;if(g+L>we&&(p=Pe(g+L)),A<64||!x){let U,B,V,q=g+P;for(U=0;U<A;U++)B=w.charCodeAt(U),B<128?p[q++]=B:B<2048?(p[q++]=B>>6|192,p[q++]=B&63|128):(B&64512)===55296&&((V=w.charCodeAt(U+1))&64512)===56320?(B=65536+((B&1023)<<10)+(V&1023),U++,p[q++]=B>>18|240,p[q++]=B>>12&63|128,p[q++]=B>>6&63|128,p[q++]=B&63|128):(p[q++]=B>>12|224,p[q++]=B>>6&63|128,p[q++]=B&63|128);v=q-g-P}else v=x(w,g+P);v<32?p[g++]=160|v:v<256?(P<2&&p.copyWithin(g+2,g+1,g+1+v),p[g++]=217,p[g++]=v):v<65536?(P<3&&p.copyWithin(g+3,g+2,g+2+v),p[g++]=218,p[g++]=v>>8,p[g++]=v&255):(P<5&&p.copyWithin(g+5,g+3,g+3+v),p[g++]=219,X.setUint32(g,v),g+=4),g+=v}else if(C==="number")if(w>>>0===w)w<32||w<128&&this.useRecords===!1||w<64&&!this.randomAccessStructure?p[g++]=w:w<256?(p[g++]=204,p[g++]=w):w<65536?(p[g++]=205,p[g++]=w>>8,p[g++]=w&255):(p[g++]=206,X.setUint32(g,w),g+=4);else if(w>>0===w)w>=-32?p[g++]=256+w:w>=-128?(p[g++]=208,p[g++]=w+256):w>=-32768?(p[g++]=209,X.setInt16(g,w),g+=2):(p[g++]=210,X.setInt32(g,w),g+=4);else{let A;if((A=this.useFloat32)>0&&w<4294967296&&w>=-2147483648){p[g++]=202,X.setFloat32(g,w);let P;if(A<4||(P=w*$t[(p[g]&127)<<1|p[g+1]>>7])>>0===P){g+=4;return}else g--}p[g++]=203,X.setFloat64(g,w),g+=8}else if(C==="object"||C==="function")if(!w)p[g++]=192;else{if(u){let P=u.get(w);if(P){if(!P.id){let L=u.idsToInsert||(u.idsToInsert=[]);P.id=L.push(P)}p[g++]=214,p[g++]=112,X.setUint32(g,P.id),g+=4;return}else u.set(w,{offset:g-a})}let A=w.constructor;if(A===Object)Qe(w);else if(A===Array)Re(w);else if(A===Map)if(this.mapAsEmptyObject)p[g++]=128;else{v=w.size,v<16?p[g++]=128|v:v<65536?(p[g++]=222,p[g++]=v>>8,p[g++]=v&255):(p[g++]=223,X.setUint32(g,v),g+=4);for(let[P,L]of w)G(P),G(L)}else{for(let P=0,L=gn.length;P<L;P++){let U=lr[P];if(w instanceof U){let B=gn[P];if(B.write){B.type&&(p[g++]=212,p[g++]=B.type,p[g++]=0);let he=B.write.call(this,w);he===w?Array.isArray(w)?Re(w):Qe(w):G(he);return}let V=p,q=X,Ae=g;p=null;let ve;try{ve=B.pack.call(this,w,he=>(p=V,V=null,g+=he,g>we&&Pe(g),{target:p,targetView:X,position:g-he}),G)}finally{V&&(p=V,X=q,g=Ae,we=p.length-10)}ve&&(ve.length+g>we&&Pe(ve.length+g),g=Pa(ve,p,g,B.type));return}}if(Array.isArray(w))Re(w);else{if(w.toJSON){let P=w.toJSON();if(P!==w)return G(P)}if(C==="function")return G(this.writeFunction&&this.writeFunction(w));Qe(w)}}}else if(C==="boolean")p[g++]=w?195:194;else if(C==="bigint"){if(w<BigInt(1)<<BigInt(63)&&w>=-(BigInt(1)<<BigInt(63)))p[g++]=211,X.setBigInt64(g,w);else if(w<BigInt(1)<<BigInt(64)&&w>0)p[g++]=207,X.setBigUint64(g,w);else if(this.largeBigIntToFloat)p[g++]=203,X.setFloat64(g,Number(w));else{if(this.largeBigIntToString)return G(w.toString());if(this.useBigIntExtension&&w<BigInt(2)**BigInt(1023)&&w>-(BigInt(2)**BigInt(1023))){p[g++]=199,g++,p[g++]=66;let A=[],P;do{let L=w&BigInt(255);P=(L&BigInt(128))===(w<BigInt(0)?BigInt(128):BigInt(0)),A.push(L),w>>=BigInt(8)}while(!((w===BigInt(0)||w===BigInt(-1))&&P));p[g-2]=A.length;for(let L=A.length;L>0;)p[g++]=Number(A[--L]);return}else throw new RangeError(w+" was too large to fit in MessagePack 64-bit integer format, use useBigIntExtension, or set largeBigIntToFloat to convert to float-64, or set largeBigIntToString to convert to string")}g+=8}else if(C==="undefined")this.encodeUndefinedAsNil?p[g++]=192:(p[g++]=212,p[g++]=0,p[g++]=0);else throw new Error("Unknown type: "+C)},Lt=this.variableMapSize||this.coercibleKeyAsNumber||this.skipValues?w=>{let C;if(this.skipValues){C=[];for(let P in w)(typeof w.hasOwnProperty!="function"||w.hasOwnProperty(P))&&!this.skipValues.includes(w[P])&&C.push(P)}else C=Object.keys(w);let v=C.length;v<16?p[g++]=128|v:v<65536?(p[g++]=222,p[g++]=v>>8,p[g++]=v&255):(p[g++]=223,X.setUint32(g,v),g+=4);let A;if(this.coercibleKeyAsNumber)for(let P=0;P<v;P++){A=C[P];let L=Number(A);G(isNaN(L)?A:L),G(w[A])}else for(let P=0;P<v;P++)G(A=C[P]),G(w[A])}:w=>{p[g++]=222;let C=g-a;g+=2;let v=0;for(let A in w)(typeof w.hasOwnProperty!="function"||w.hasOwnProperty(A))&&(G(A),G(w[A]),v++);if(v>65535)throw new Error('Object is too large to serialize with fast 16-bit map size, use the "variableMapSize" option to serialize this object');p[C+++a]=v>>8,p[C+a]=v&255},It=this.useRecords===!1?Lt:n.progressiveRecords&&!H?w=>{let C,v=d.transitions||(d.transitions=Object.create(null)),A=g++-a,P;for(let L in w)if(typeof w.hasOwnProperty!="function"||w.hasOwnProperty(L)){if(C=v[L],C)v=C;else{let U=Object.keys(w),B=v;v=d.transitions;let V=0;for(let q=0,Ae=U.length;q<Ae;q++){let ve=U[q];C=v[ve],C||(C=v[ve]=Object.create(null),V++),v=C}A+a+1==g?(g--,lt(v,U,V)):Bt(v,U,A,V),P=!0,v=B[L]}G(w[L])}if(!P){let L=v[Ot];L?p[A+a]=L:Bt(v,Object.keys(w),A,0)}}:w=>{let C,v=d.transitions||(d.transitions=Object.create(null)),A=0;for(let L in w)(typeof w.hasOwnProperty!="function"||w.hasOwnProperty(L))&&(C=v[L],C||(C=v[L]=Object.create(null),A++),v=C);let P=v[Ot];P?P>=96&&H?(p[g++]=((P-=96)&31)+96,p[g++]=P>>5):p[g++]=P:lt(v,v.__keys__||Object.keys(w),A);for(let L in w)(typeof w.hasOwnProperty!="function"||w.hasOwnProperty(L))&&G(w[L])},On=typeof this.useRecords=="function"&&this.useRecords,Qe=On?w=>{On(w)?It(w):Lt(w)}:It,Pe=w=>{let C;if(w>16777216){if(w-a>Fs)throw new Error("Packed buffer would be larger than maximum buffer size");C=Math.min(Fs,Math.round(Math.max((w-a)*(w>67108864?1.25:2),4194304)/4096)*4096)}else C=(Math.max(w-a<<2,p.length-1)>>12)+1<<12;let v=new un(C);return X=v.dataView||(v.dataView=new DataView(v.buffer,0,C)),w=Math.min(w,p.length),p.copy?p.copy(v,0,a,w):v.set(p.slice(a,w)),g-=a,a=0,we=v.length-10,p=v},lt=(w,C,v)=>{let A=d.nextId;A||(A=64),A<ee&&this.shouldShareStructure&&!this.shouldShareStructure(C)?(A=d.nextOwnId,A<te||(A=ee),d.nextOwnId=A+1):(A>=te&&(A=ee),d.nextId=A+1);let P=C.highByte=A>=96&&H?A-96>>5:-1;w[Ot]=A,w.__keys__=C,d[A-64]=C,A<ee?(C.isShared=!0,d.sharedLength=A-63,f=!0,P>=0?(p[g++]=(A&31)+96,p[g++]=P):p[g++]=A):(P>=0?(p[g++]=213,p[g++]=114,p[g++]=(A&31)+96,p[g++]=P):(p[g++]=212,p[g++]=114,p[g++]=A),v&&(Se+=ft*v),oe.length>=Q&&(oe.shift()[Ot]=0),oe.push(w),G(C))},Bt=(w,C,v,A)=>{let P=p,L=g,U=we,B=a;p=Mt,g=0,a=0,p||(Mt=p=new un(8192)),we=p.length-10,lt(w,C,A),Mt=p;let V=g;if(p=P,g=L,we=U,a=B,V>1){let q=g+V-1;q>we&&Pe(q);let Ae=v+a;p.copyWithin(Ae+V,Ae+1,g),p.set(Mt.slice(0,V),Ae),g=q}else p[v+a]=Mt[0]},Ft=w=>{let C=_a(w,p,a,g,d,Pe,(v,A,P)=>{if(P)return f=!0;g=A;let L=p;return G(v),Xe(),L!==p?{position:g,targetView:X,target:p}:g},this);if(C===0)return Qe(w);g=C}}useBuffer(n){p=n,p.dataView||(p.dataView=new DataView(p.buffer,p.byteOffset,p.byteLength)),g=0}set position(n){g=n}get position(){return g}set buffer(n){p=n}get buffer(){return p}clearSharedData(){this.structures&&(this.structures=[]),this.typedStructs&&(this.typedStructs=[])}};lr=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,Pt];gn=[{pack(t,n,s){let a=t.getTime()/1e3;if((this.useTimestamp32||t.getMilliseconds()===0)&&a>=0&&a<4294967296){let{target:f,targetView:d,position:u}=n(6);f[u++]=214,f[u++]=255,d.setUint32(u,a)}else if(a>0&&a<4294967296){let{target:f,targetView:d,position:u}=n(10);f[u++]=215,f[u++]=255,d.setUint32(u,t.getMilliseconds()*4e6+(a/1e3/4294967296>>0)),d.setUint32(u+4,a)}else if(isNaN(a)){if(this.onInvalidDate)return n(0),s(this.onInvalidDate());let{target:f,targetView:d,position:u}=n(3);f[u++]=212,f[u++]=255,f[u++]=255}else{let{target:f,targetView:d,position:u}=n(15);f[u++]=199,f[u++]=12,f[u++]=255,d.setUint32(u,t.getMilliseconds()*1e6),d.setBigInt64(u+4,BigInt(Math.floor(a)))}}},{pack(t,n,s){if(this.setAsEmptyObject)return n(0),s({});let a=Array.from(t),{target:f,position:d}=n(this.moreTypes?3:0);this.moreTypes&&(f[d++]=212,f[d++]=115,f[d++]=0),s(a)}},{pack(t,n,s){let{target:a,position:f}=n(this.moreTypes?3:0);this.moreTypes&&(a[f++]=212,a[f++]=101,a[f++]=0),s([t.name,t.message,t.cause])}},{pack(t,n,s){let{target:a,position:f}=n(this.moreTypes?3:0);this.moreTypes&&(a[f++]=212,a[f++]=120,a[f++]=0),s([t.source,t.flags])}},{pack(t,n){this.moreTypes?js(t,16,n):Us(pn?Buffer.from(t):new Uint8Array(t),n)}},{pack(t,n){let s=t.constructor;s!==Vs&&this.moreTypes?js(t,fr.indexOf(s.name),n):Us(t,n)}},{pack(t,n){let{target:s,position:a}=n(1);s[a]=193}}];Ws=new ze({useRecords:!1}),Hs=Ws.pack,Js=Ws.pack,Ks=ze,{NEVER:Ys,ALWAYS:Gs,DECIMAL_ROUND:Zs,DECIMAL_FIT:Xs}=Nt,dr=512,hr=1024,ur=2048});function $a(t,n={}){if(!t||typeof t!="object")throw new Error("first argument must be an Iterable, Async Iterable, or a Promise for an Async Iterable");if(typeof t[Symbol.iterator]=="function")return Na(t,n);if(typeof t.then=="function"||typeof t[Symbol.asyncIterator]=="function")return Ma(t,n);throw new Error("first argument must be an Iterable, Async Iterable, Iterator, Async Iterator, or a Promise")}function*Na(t,n){let s=new ze(n);for(let a of t)yield s.pack(a)}function Ma(t,n){return _n(this,null,function*(){let s=new ze(n);try{for(var a=Rn(t),f,d,u;f=!(d=yield new _t(a.next())).done;f=!1){let x=d.value;yield s.pack(x)}}catch{u=[d]}finally{try{f&&(d=a.return)&&(yield new _t(d.call(a)))}finally{if(u)throw u[0]}}})}function La(t,n={}){if(!t||typeof t!="object")throw new Error("first argument must be an Iterable, Async Iterable, Iterator, Async Iterator, or a promise");let s=new Be(n),a,f=d=>{let u;a&&(d=Buffer.concat([a,d]),a=void 0);try{u=s.unpackMultiple(d)}catch(x){if(x.incomplete)a=d.slice(x.lastPosition),u=x.values;else throw x}return u};if(typeof t[Symbol.iterator]=="function")return function*(){for(let u of t)yield*Cn(f(u))}();if(typeof t[Symbol.asyncIterator]=="function")return function(){return _n(this,null,function*(){try{for(var u=Rn(t),x,T,y;x=!(T=yield new _t(u.next())).done;x=!1){let N=T.value;yield*Cn(f(N))}}catch{y=[T]}finally{try{x&&(T=u.return)&&(yield new _t(T.call(u)))}finally{if(y)throw y[0]}}})}()}var Qs,eo,to=Tt(()=>{"use strict";mr();xt();Qs=La,eo=$a});var no={};si(no,{ALWAYS:()=>Gs,C1:()=>dn,DECIMAL_FIT:()=>Xs,DECIMAL_ROUND:()=>Zs,Decoder:()=>ks,Encoder:()=>Ks,FLOAT32_OPTIONS:()=>Nt,NEVER:()=>Ys,Packr:()=>ze,RESERVE_START_SPACE:()=>ur,RESET_BUFFER_MODE:()=>hr,REUSE_BUFFER_MODE:()=>dr,Unpackr:()=>Be,addExtension:()=>qs,clearSource:()=>Dt,decode:()=>Ms,decodeIter:()=>Qs,encode:()=>Js,encodeIter:()=>eo,isNativeAccelerationEnabled:()=>Ts,mapsAsObjects:()=>Fa,pack:()=>Hs,roundFloat32:()=>Bs,unpack:()=>$s,unpackMultiple:()=>Ns,useRecords:()=>Ba});var Ba,Fa,ro=Tt(()=>{"use strict";mr();xt();to();Ba=!1,Fa=!0});var pr=re(ao=>{"use strict";var ja=cs(),Ce=Kn(),io=Gn(),Ua=Zn(),yn=ds(),ge=an(),za=tr(),so=Rt(),oo=(ro(),bt(no)),gr=class t{constructor(n,s){this.onStateChange=yn.createSignal(),this.onError=yn.createSignal(),this.onLeave=yn.createSignal(),this.onJoin=yn.createSignal(),this.hasJoined=!1,this.onMessageHandlers=Ua.createNanoEvents(),this.roomId=null,this.name=n,this.packr=new oo.Packr,this.packr.encode(void 0),s&&(this.serializer=new(io.getSerializer("schema")),this.rootSchema=s,this.serializer.state=new s),this.onError((a,f)=>{var d;return(d=console.warn)===null||d===void 0?void 0:d.call(console,`colyseus.js - onError => (${a}) ${f}`)}),this.onLeave(()=>this.removeAllListeners())}connect(n,s,a=this,f,d){let u=new ja.Connection(f.protocol);if(a.connection=u,u.events.onmessage=t.prototype.onMessageCallback.bind(a),u.events.onclose=function(x){var T;if(!a.hasJoined){(T=console.warn)===null||T===void 0||T.call(console,`Room connection was closed unexpectedly (${x.code}): ${x.reason}`),a.onError.invoke(x.code,x.reason);return}x.code===so.CloseCode.DEVMODE_RESTART&&s?s():(a.onLeave.invoke(x.code,x.reason),a.destroy())},u.events.onerror=function(x){var T;(T=console.warn)===null||T===void 0||T.call(console,`Room, onError (${x.code}): ${x.reason}`),a.onError.invoke(x.code,x.reason)},f.protocol==="h3"){let x=new URL(n);u.connect(x.origin,f)}else u.connect(n,d)}leave(n=!0){return new Promise(s=>{this.onLeave(a=>s(a)),this.connection?n?(this.packr.buffer[0]=Ce.Protocol.LEAVE_ROOM,this.connection.send(this.packr.buffer.subarray(0,1))):this.connection.close():this.onLeave.invoke(so.CloseCode.CONSENTED)})}onMessage(n,s){return this.onMessageHandlers.on(this.getMessageHandlerKey(n),s)}send(n,s){let a={offset:1};this.packr.buffer[0]=Ce.Protocol.ROOM_DATA,typeof n=="string"?ge.encode.string(this.packr.buffer,n,a):ge.encode.number(this.packr.buffer,n,a),this.packr.position=0;let f=s!==void 0?this.packr.pack(s,2048+a.offset):this.packr.buffer.subarray(0,a.offset);this.connection.send(f)}sendUnreliable(n,s){let a={offset:1};this.packr.buffer[0]=Ce.Protocol.ROOM_DATA,typeof n=="string"?ge.encode.string(this.packr.buffer,n,a):ge.encode.number(this.packr.buffer,n,a),this.packr.position=0;let f=s!==void 0?this.packr.pack(s,2048+a.offset):this.packr.buffer.subarray(0,a.offset);this.connection.sendUnreliable(f)}sendBytes(n,s){let a={offset:1};if(this.packr.buffer[0]=Ce.Protocol.ROOM_DATA_BYTES,typeof n=="string"?ge.encode.string(this.packr.buffer,n,a):ge.encode.number(this.packr.buffer,n,a),s.byteLength+a.offset>this.packr.buffer.byteLength){let f=new Uint8Array(a.offset+s.byteLength);f.set(this.packr.buffer),this.packr.useBuffer(f)}this.packr.buffer.set(s,a.offset),this.connection.send(this.packr.buffer.subarray(0,a.offset+s.byteLength))}get state(){return this.serializer.getState()}removeAllListeners(){this.onJoin.clear(),this.onStateChange.clear(),this.onError.clear(),this.onLeave.clear(),this.onMessageHandlers.events={},this.serializer instanceof za.SchemaSerializer&&(this.serializer.decoder.root.callbacks={})}onMessageCallback(n){let s=new Uint8Array(n.data),a={offset:1},f=s[0];if(f===Ce.Protocol.JOIN_ROOM){let d=ge.decode.utf8Read(s,a,s[a.offset++]);if(this.serializerId=ge.decode.utf8Read(s,a,s[a.offset++]),!this.serializer){let u=io.getSerializer(this.serializerId);this.serializer=new u}s.byteLength>a.offset&&this.serializer.handshake&&this.serializer.handshake(s,a),this.reconnectionToken=`${this.roomId}:${d}`,this.hasJoined=!0,this.onJoin.invoke(),this.packr.buffer[0]=Ce.Protocol.JOIN_ROOM,this.connection.send(this.packr.buffer.subarray(0,1))}else if(f===Ce.Protocol.ERROR){let d=ge.decode.number(s,a),u=ge.decode.string(s,a);this.onError.invoke(d,u)}else if(f===Ce.Protocol.LEAVE_ROOM)this.leave();else if(f===Ce.Protocol.ROOM_STATE)this.serializer.setState(s,a),this.onStateChange.invoke(this.serializer.getState());else if(f===Ce.Protocol.ROOM_STATE_PATCH)this.serializer.patch(s,a),this.onStateChange.invoke(this.serializer.getState());else if(f===Ce.Protocol.ROOM_DATA){let d=ge.decode.stringCheck(s,a)?ge.decode.string(s,a):ge.decode.number(s,a),u=s.byteLength>a.offset?oo.unpack(s,{start:a.offset}):void 0;this.dispatchMessage(d,u)}else if(f===Ce.Protocol.ROOM_DATA_BYTES){let d=ge.decode.stringCheck(s,a)?ge.decode.string(s,a):ge.decode.number(s,a);this.dispatchMessage(d,s.subarray(a.offset))}}dispatchMessage(n,s){var a;let f=this.getMessageHandlerKey(n);this.onMessageHandlers.events[f]?this.onMessageHandlers.emit(f,s):this.onMessageHandlers.events["*"]?this.onMessageHandlers.emit("*",n,s):(a=console.warn)===null||a===void 0||a.call(console,`colyseus.js: onMessage() not registered for type '${n}'.`)}destroy(){this.serializer&&this.serializer.teardown()}getMessageHandlerKey(n){switch(typeof n){case"string":return n;case"number":return`i${n}`;default:throw new Error("invalid message type.")}}};ao.Room=gr});var fo={};si(fo,{del:()=>Ha,get:()=>Va,patch:()=>Wa,post:()=>qa,put:()=>Ja,send:()=>$e});function co(t,n){n.headers=t.headers||{},n.statusMessage=t.statusText,n.statusCode=t.status,n.data=t.response}function $e(t,n,s){return new Promise(function(a,f){s=s||{};var d=new XMLHttpRequest,u,x,T,y=s.body,N=s.headers||{};s.timeout&&(d.timeout=s.timeout),d.ontimeout=d.onerror=function(F){F.timeout=F.type=="timeout",f(F)},d.open(t,n.href||n),d.onload=function(){for(T=d.getAllResponseHeaders().trim().split(/[\r\n]+/),co(d,d);x=T.shift();)x=x.split(": "),d.headers[x.shift().toLowerCase()]=x.join(": ");if(x=d.headers["content-type"],x&&~x.indexOf("application/json"))try{d.data=JSON.parse(d.data,s.reviver)}catch(F){return co(d,F),f(F)}(d.status>=400?f:a)(d)},typeof FormData<"u"&&y instanceof FormData||y&&typeof y=="object"&&(N["content-type"]="application/json",y=JSON.stringify(y)),d.withCredentials=!!s.withCredentials;for(u in N)d.setRequestHeader(u,N[u]);d.send(y)})}var Va,qa,Wa,Ha,Ja,lo=Tt(()=>{"use strict";Va=$e.bind($e,"GET"),qa=$e.bind($e,"POST"),Wa=$e.bind($e,"PATCH"),Ha=$e.bind($e,"DELETE"),Ja=$e.bind($e,"PUT")});var uo=re(ho=>{"use strict";var Ka=Rt(),Ya=(lo(),bt(fo));function Ga(t){var n=Object.create(null);return t&&Object.keys(t).forEach(function(s){if(s!=="default"){var a=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(n,s,a.get?a:{enumerable:!0,get:function(){return t[s]}})}}),n.default=t,Object.freeze(n)}var Za=Ga(Ya),yr=class{constructor(n,s={}){this.client=n,this.headers=s}get(n,s={}){return this.request("get",n,s)}post(n,s={}){return this.request("post",n,s)}del(n,s={}){return this.request("del",n,s)}put(n,s={}){return this.request("put",n,s)}request(n,s,a={}){return Za[n](this.client.getHttpEndpoint(s),this.getOptions(a)).catch(f=>{var d;let u=f.statusCode,x=((d=f.data)===null||d===void 0?void 0:d.error)||f.statusMessage||f.message;throw!u&&!x?f:new Ka.ServerError(u,x)})}getOptions(n){return n.headers=Object.assign({},this.headers,n.headers),this.authToken&&(n.headers.Authorization=`Bearer ${this.authToken}`),typeof cc<"u"&&cc.sys&&cc.sys.isNative||(n.withCredentials=!0),n}};ho.HTTP=yr});var go=re(bn=>{"use strict";var mo=(Kt(),bt(Jt)),ct;function wr(){if(!ct)try{ct=typeof cc<"u"&&cc.sys&&cc.sys.localStorage?cc.sys.localStorage:window.localStorage}catch{}return!ct&&typeof globalThis.indexedDB<"u"&&(ct=new br),ct||(ct={cache:{},setItem:function(t,n){this.cache[t]=n},getItem:function(t){this.cache[t]},removeItem:function(t){delete this.cache[t]}}),ct}function Xa(t,n){wr().setItem(t,n)}function Qa(t){wr().removeItem(t)}function ec(t,n){let s=wr().getItem(t);typeof Promise>"u"||!(s instanceof Promise)?n(s):s.then(a=>n(a))}var br=class{constructor(){this.dbPromise=new Promise(n=>{let s=indexedDB.open("_colyseus_storage",1);s.onupgradeneeded=()=>s.result.createObjectStore("store"),s.onsuccess=()=>n(s.result)})}tx(n,s){return mo.__awaiter(this,void 0,void 0,function*(){let f=(yield this.dbPromise).transaction("store",n).objectStore("store");return s(f)})}setItem(n,s){return this.tx("readwrite",a=>a.put(s,n)).then()}getItem(n){return mo.__awaiter(this,void 0,void 0,function*(){let s=yield this.tx("readonly",a=>a.get(n));return new Promise(a=>{s.onsuccess=()=>a(s.result)})})}removeItem(n){return this.tx("readwrite",s=>s.delete(n)).then()}};bn.getItem=ec;bn.removeItem=Qa;bn.setItem=Xa});var Ir=re(po=>{"use strict";var de=(Kt(),bt(Jt)),Er=go(),tc=Zn(),wn,xr,Ze,En,Or=class{constructor(n){this.http=n,this.settings={path:"/auth",key:"colyseus-auth-token"},wn.set(this,!1),xr.set(this,void 0),Ze.set(this,void 0),En.set(this,tc.createNanoEvents()),Er.getItem(this.settings.key,s=>this.token=s)}set token(n){this.http.authToken=n}get token(){return this.http.authToken}onChange(n){let s=de.__classPrivateFieldGet(this,En,"f").on("change",n);return de.__classPrivateFieldGet(this,wn,"f")||de.__classPrivateFieldSet(this,xr,new Promise((a,f)=>{this.getUserData().then(d=>{this.emitChange(Object.assign(Object.assign({},d),{token:this.token}))}).catch(d=>{this.emitChange({user:null,token:void 0})}).finally(()=>{a()})}),"f"),de.__classPrivateFieldSet(this,wn,!0,"f"),s}getUserData(){return de.__awaiter(this,void 0,void 0,function*(){if(this.token)return(yield this.http.get(`${this.settings.path}/userdata`)).data;throw new Error("missing auth.token")})}registerWithEmailAndPassword(n,s,a){return de.__awaiter(this,void 0,void 0,function*(){let f=(yield this.http.post(`${this.settings.path}/register`,{body:{email:n,password:s,options:a}})).data;return this.emitChange(f),f})}signInWithEmailAndPassword(n,s){return de.__awaiter(this,void 0,void 0,function*(){let a=(yield this.http.post(`${this.settings.path}/login`,{body:{email:n,password:s}})).data;return this.emitChange(a),a})}signInAnonymously(n){return de.__awaiter(this,void 0,void 0,function*(){let s=(yield this.http.post(`${this.settings.path}/anonymous`,{body:{options:n}})).data;return this.emitChange(s),s})}sendPasswordResetEmail(n){return de.__awaiter(this,void 0,void 0,function*(){return(yield this.http.post(`${this.settings.path}/forgot-password`,{body:{email:n}})).data})}signInWithProvider(n){return de.__awaiter(this,arguments,void 0,function*(s,a={}){return new Promise((f,d)=>{let u=a.width||480,x=a.height||768,T=this.token?`?token=${this.token}`:"",y=`Login with ${s[0].toUpperCase()+s.substring(1)}`,N=this.http.client.getHttpEndpoint(`${a.prefix||`${this.settings.path}/provider`}/${s}${T}`),F=screen.width/2-u/2,Q=screen.height/2-x/2;de.__classPrivateFieldSet(this,Ze,window.open(N,y,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+u+", height="+x+", top="+Q+", left="+F),"f");let H=te=>{te.data.user===void 0&&te.data.token===void 0||(clearInterval(ee),de.__classPrivateFieldGet(this,Ze,"f").close(),de.__classPrivateFieldSet(this,Ze,void 0,"f"),window.removeEventListener("message",H),te.data.error!==void 0?d(te.data.error):(f(te.data),this.emitChange(te.data)))},ee=setInterval(()=>{(!de.__classPrivateFieldGet(this,Ze,"f")||de.__classPrivateFieldGet(this,Ze,"f").closed)&&(de.__classPrivateFieldSet(this,Ze,void 0,"f"),d("cancelled"),window.removeEventListener("message",H))},200);window.addEventListener("message",H)})})}signOut(){return de.__awaiter(this,void 0,void 0,function*(){this.emitChange({user:null,token:null})})}emitChange(n){n.token!==void 0&&(this.token=n.token,n.token===null?Er.removeItem(this.settings.key):Er.setItem(this.settings.key,n.token)),de.__classPrivateFieldGet(this,En,"f").emit("change",n)}};wn=new WeakMap,xr=new WeakMap,Ze=new WeakMap,En=new WeakMap;po.Auth=Or});var bo=re(yo=>{"use strict";function nc(t){var n;let s=((n=window?.location)===null||n===void 0?void 0:n.hostname)||"localhost",a=t.hostname.split("."),f=!t.hostname.includes("trycloudflare.com")&&!t.hostname.includes("discordsays.com")&&a.length>2?`/${a[0]}`:"";return t.pathname.startsWith("/.proxy")?`${t.protocol}//${s}${f}${t.pathname}${t.search}`:`${t.protocol}//${s}/.proxy/colyseus${f}${t.pathname}${t.search}`}yo.discordURLBuilder=nc});var Eo=re(Ar=>{"use strict";var Ve=(Kt(),bt(Jt)),rc=Rt(),ic=pr(),sc=uo(),oc=Ir(),ac=bo(),Sr,xn=class t extends Error{constructor(n,s){super(n),this.code=s,this.name="MatchMakeError",Object.setPrototypeOf(this,t.prototype)}},wo=typeof window<"u"&&typeof((Sr=window?.location)===null||Sr===void 0?void 0:Sr.hostname)<"u"?`${window.location.protocol.replace("http","ws")}//${window.location.hostname}${window.location.port&&`:${window.location.port}`}`:"ws://127.0.0.1:2567",fc=(()=>{class t{constructor(s=wo,a){var f,d;if(typeof s=="string"){let u=s.startsWith("/")?new URL(s,wo):new URL(s),x=u.protocol==="https:"||u.protocol==="wss:",T=Number(u.port||(x?443:80));this.settings={hostname:u.hostname,pathname:u.pathname,port:T,secure:x}}else s.port===void 0&&(s.port=s.secure?443:80),s.pathname===void 0&&(s.pathname=""),this.settings=s;this.settings.pathname.endsWith("/")&&(this.settings.pathname=this.settings.pathname.slice(0,-1)),this.http=new sc.HTTP(this,a?.headers||{}),this.auth=new oc.Auth(this.http),this.urlBuilder=a?.urlBuilder,!this.urlBuilder&&typeof window<"u"&&(!((d=(f=window?.location)===null||f===void 0?void 0:f.hostname)===null||d===void 0)&&d.includes("discordsays.com"))&&(this.urlBuilder=ac.discordURLBuilder,console.log("Colyseus SDK: Discord Embedded SDK detected. Using custom URL builder."))}joinOrCreate(s){return Ve.__awaiter(this,arguments,void 0,function*(a,f={},d){return yield this.createMatchMakeRequest("joinOrCreate",a,f,d)})}create(s){return Ve.__awaiter(this,arguments,void 0,function*(a,f={},d){return yield this.createMatchMakeRequest("create",a,f,d)})}join(s){return Ve.__awaiter(this,arguments,void 0,function*(a,f={},d){return yield this.createMatchMakeRequest("join",a,f,d)})}joinById(s){return Ve.__awaiter(this,arguments,void 0,function*(a,f={},d){return yield this.createMatchMakeRequest("joinById",a,f,d)})}reconnect(s,a){return Ve.__awaiter(this,void 0,void 0,function*(){if(typeof s=="string"&&typeof a=="string")throw new Error("DEPRECATED: .reconnect() now only accepts 'reconnectionToken' as argument.\nYou can get this token from previously connected `room.reconnectionToken`");let[f,d]=s.split(":");if(!f||!d)throw new Error(`Invalid reconnection token format.
The format should be roomId:reconnectionToken`);return yield this.createMatchMakeRequest("reconnect",f,{reconnectionToken:d},a)})}consumeSeatReservation(s,a,f){return Ve.__awaiter(this,void 0,void 0,function*(){let d=this.createRoom(s.room.name,a);d.roomId=s.room.roomId,d.sessionId=s.sessionId;let u={sessionId:d.sessionId};s.reconnectionToken&&(u.reconnectionToken=s.reconnectionToken);let x=f||d;return d.connect(this.buildEndpoint(s.room,u,s.protocol),s.devMode&&(()=>Ve.__awaiter(this,void 0,void 0,function*(){console.info(`[Colyseus devMode]: ${String.fromCodePoint(128260)} Re-establishing connection with room id '${d.roomId}'...`);let T=0,y=8,N=()=>Ve.__awaiter(this,void 0,void 0,function*(){T++;try{yield this.consumeSeatReservation(s,a,x),console.info(`[Colyseus devMode]: ${String.fromCodePoint(9989)} Successfully re-established connection with room '${d.roomId}'`)}catch{T<y?(console.info(`[Colyseus devMode]: ${String.fromCodePoint(128260)} retrying... (${T} out of ${y})`),setTimeout(N,2e3)):console.info(`[Colyseus devMode]: ${String.fromCodePoint(10060)} Failed to reconnect. Is your server running? Please check server logs.`)}});setTimeout(N,2e3)})),x,s,this.http.headers),new Promise((T,y)=>{let N=(F,Q)=>y(new rc.ServerError(F,Q));x.onError.once(N),x.onJoin.once(()=>{x.onError.remove(N),T(x)})})})}createMatchMakeRequest(s,a){return Ve.__awaiter(this,arguments,void 0,function*(f,d,u={},x,T){let y=(yield this.http.post(`matchmake/${f}/${d}`,{headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(u)})).data;if(y.error)throw new xn(y.error,y.code);return f==="reconnect"&&(y.reconnectionToken=u.reconnectionToken),yield this.consumeSeatReservation(y,x,T)})}createRoom(s,a){return new ic.Room(s,a)}buildEndpoint(s,a={},f="ws"){let d=[];for(let T in a)a.hasOwnProperty(T)&&d.push(`${T}=${a[T]}`);f==="h3"&&(f="http");let u=this.settings.secure?`${f}s://`:`${f}://`;s.publicAddress?u+=`${s.publicAddress}`:u+=`${this.settings.hostname}${this.getEndpointPort()}${this.settings.pathname}`;let x=`${u}/${s.processId}/${s.roomId}?${d.join("&")}`;return this.urlBuilder?this.urlBuilder(new URL(x)):x}getHttpEndpoint(s=""){let a=s.startsWith("/")?s:`/${s}`,f=`${this.settings.secure?"https":"http"}://${this.settings.hostname}${this.getEndpointPort()}${this.settings.pathname}${a}`;return this.urlBuilder?this.urlBuilder(new URL(f)):f}getEndpointPort(){return this.settings.port!==80&&this.settings.port!==443?`:${this.settings.port}`:""}}return t.VERSION="0.16.15",t})();Ar.Client=fc;Ar.MatchMakeError=xn});var Oo=re(xo=>{"use strict";var vr=class{setState(n){}getState(){return null}patch(n){}teardown(){}handshake(n){}};xo.NoneSerializer=vr});var Ao=re(Ne=>{"use strict";Wi();var Io=Eo(),So=Kn(),lc=pr(),dc=Ir(),hc=Rt(),Tr=tr(),uc=Oo(),_r=Gn();_r.registerSerializer("schema",Tr.SchemaSerializer);_r.registerSerializer("none",uc.NoneSerializer);Ne.Client=Io.Client;Ne.MatchMakeError=Io.MatchMakeError;Object.defineProperty(Ne,"ErrorCode",{enumerable:!0,get:function(){return So.ErrorCode}});Object.defineProperty(Ne,"Protocol",{enumerable:!0,get:function(){return So.Protocol}});Ne.Room=lc.Room;Ne.Auth=dc.Auth;Ne.ServerError=hc.ServerError;Ne.SchemaSerializer=Tr.SchemaSerializer;Ne.getStateCallbacks=Tr.getStateCallbacks;Ne.registerSerializer=_r.registerSerializer});var To=ea(Ao());function mc(t,n){if(t&1&&(J(0,"mat-option",9),ae(1),K()),t&2){let s=n.$implicit;Je("value",s),be(),kn(s.name)}}function gc(t,n){if(t&1&&(J(0,"div",29)(1,"div",30)(2,"div",31)(3,"span",32),ae(4),K(),J(5,"div",33)(6,"mat-icon",34),ae(7,"person"),K(),J(8,"span",35),ae(9),K()()()()()),t&2){let s=n.$implicit;be(4),kn(s.name),be(5),mi("",s.clients,"/",s.maxClients,"")}}function pc(t,n){t&1&&(J(0,"span",36),ae(1,"Room name is not valid or already exists"),K())}function yc(t,n){t&1&&(J(0,"span",37),ae(1,"Room password is not valid"),K())}function bc(t,n){if(t&1){let s=ui();J(0,"input",38),it("ngModelChange",function(f){ai(s);let d=Dn();return rt(d.roomPass,f)||(d.roomPass=f),ci(f)}),K()}if(t&2){let s=Dn();nt("ngModel",s.roomPass)}}var _o=(()=>{class t{constructor(s){this.routerService=s,this.client=new To.Client("https://155-138-239-22.colyseus.dev"),this.roomList=[],this.decksQuery=wi(()=>Ei.decks.toArray()),this.decks=[],this.deckSelect=new Ri(""),this.headerLinks=["home","decks","options","ai"],this.matcher=new zi(yt(yt({},Vi.build()),qi)),this.roomName="",this.privateRoomName="",this.roomPass="",this.joinPass="",this.isPrivate=!1,this.validRoomPass=!0,this.validRoomName=!0}ngOnInit(){this.loadDecks(),this.playerName=localStorage.getItem("playerName")}ngAfterViewInit(){this.refreshRooms()}createRoom(){this.client.http.get("/room_list").then(s=>{if(this.roomList=JSON.parse(s.data),this.roomList.forEach(a=>{if(a.name===this.roomName){this.validRoomName=!1;return}}),this.matcher.hasMatch(this.roomName)||!this.roomName||this.roomName===""){this.validRoomName=!1;return}}),this.validRoomName&&this.client.http.post("/create_room",{body:{roomName:this.roomName,createdBy:this.playerName,roomPassword:this.isPrivate?this.roomPass:null}}).then(s=>{s.statusCode!==401&&(this.client.joinById(s.data.roomId),this.navigateToPage("play"))})}joinPrivateRoom(){if(!this.isPrivate||this.joinPass===""||this.privateRoomName===""){this.validRoomPass=!1;return}try{this.client.http.post("/join_private",{body:{roomName:this.privateRoomName,roomPassword:this.joinPass}}).then(s=>{s.statusCode!==401&&this.navigateToPage("play")})}catch{this.validRoomPass=!1}}refreshRooms(){this.client.http.get("/room_list").then(s=>this.roomList=JSON.parse(s.data))}joinAiGame(){}loadDecks(){this.decksQuery.subscribe(s=>{this.decks=s,this.selectedDeck=this.decks[0],localStorage.setItem("selectedDeck",JSON.stringify(this.decks[0].name))})}selectDeck(s){this.selectedDeck=s.value,localStorage.setItem("selectedDeck",JSON.stringify(s.value.name))}navigateToPage(s){this.routerService.navigateToPage(s)}static{this.\u0275fac=function(a){return new(a||t)(fi(xi))}}static{this.\u0275cmp=oi({type:t,selectors:[["app-lobby"]],decls:55,vars:12,consts:[[1,"w-full","h-full","absolute","z-[-1001]","overflow-hidden","bg-slate-500"],["src","../../../../assets/lobby-bg.png",1,"object-fill","w-full","h-full","absolute","z-[-1000]","opacity-30","overflow-hidden"],[1,"max-h-screen","overflow-hidden"],[3,"headerLinks","colorTheme"],[1,"flex","flex-row"],[1,"flex","flex-col","left-0","h-[50%]","border-2","border-solid","border-white","rounded-md","w-[15%]","ml-8","items-center"],[1,"text-white","text-lg","mt-2","underline"],[1,"flex","flex-col","items-left","text-center","w-[95%]"],[3,"selectionChange","ngModelChange","ngModel","formControl"],[1,"text-white",3,"value"],[1,"flex","flex-col","items-center","border-2","border-solid","border-white","rounded-md","ml-4","w-[60%]","mr-4"],[1,"flex","flex-row","items-center"],["matTooltip","Refresh rooms",1,"ml-4","text-emerald-600","rounded-full","bg-white","mt-2",3,"click"],["class","w-3/4",4,"ngFor","ngForOf"],[1,"flex","flex-col","left-0","h-[50%]","border-2","border-solid","border-white","rounded-md","w-[15%]","ml-8","items-center","mt-4"],[1,"flex","flex-col","items-center","mb-2"],["class","text-red-500 mt-1 mb-1 text-sm",4,"ngIf"],["class","text-red-500 mt-1 mb-1 text-sm overflow-none",4,"ngIf"],["placeholder","room name",1,"px-2","rounded-md","border","border-white","mt-2","w-[95%]",3,"ngModelChange","ngModel"],["class","mt-1 mb-1 px-2 rounded-md border border-white mt-2 w-[95%]","placeholder","room password",3,"ngModel","ngModelChange",4,"ngIf"],[1,"flex","flex-row","mt-1","mb-1","items-center"],[1,"text-white"],["type","checkbox",1,"accent-emerald-600","borer","border-white","ml-2","w-4","h-4",3,"ngModelChange","ngModel"],[1,"rounded-md","bg-white","hover:bg-slate-200","mt-2","text-emerald-600","p-4",3,"click"],[1,"text-white","mt-2"],["placeholder","name",1,"px-2","rounded-md","border","border-white","mt-2","w-[95%]",3,"ngModelChange","ngModel"],["placeholder","password",1,"px-2","rounded-md","border","border-white","mt-2","w-[95%]",3,"ngModelChange","ngModel"],[1,"rounded-md","bg-white","hover:bg-slate-200","mt-2","text-emerald-600","px-8","py-4",3,"click"],[1,"rounded-md","bg-white","hover:bg-slate-200","mt-2","text-emerald-600","p-4"],[1,"w-3/4"],[1,"flex","flex-row","w-full","hover:cursor-pointer"],[1,"rounded-md","flex","flex-row","bg-white","text-emerald-600","p-4","mt-1","mb-1","w-full","hover:bg-slate-200","border-gray-600","shadow-md","border-2","w-full"],["matTooltip","Join room",1,"text-left","ml-2","w-5/6"],[1,"flex","flex-row","right-0","w-1/6"],[1,"text-emerald-600"],[1,"text-emerald-600","ml-2"],[1,"text-red-500","mt-1","mb-1","text-sm"],[1,"text-red-500","mt-1","mb-1","text-sm","overflow-none"],["placeholder","room password",1,"mt-1","mb-1","px-2","rounded-md","border","border-white","mt-2","w-[95%]",3,"ngModelChange","ngModel"]],template:function(a,f){a&1&&(Pn(0,"div",0)(1,"img",1),J(2,"div",2),Pn(3,"app-header",3),J(4,"div",4)(5,"div",5)(6,"span",6),ae(7,"Selected Deck"),K(),J(8,"div",7)(9,"mat-form-field")(10,"mat-select",8),wt("selectionChange",function(u){return f.selectDeck(u)}),it("ngModelChange",function(u){return rt(f.selectedDeck,u)||(f.selectedDeck=u),u}),di(11,mc,2,2,"mat-option",9,li),K()()()(),J(13,"div",10)(14,"div",11)(15,"span",6),ae(16,"Available Rooms"),K(),J(17,"mat-icon",12),wt("click",function(){return f.refreshRooms()}),ae(18,"refresh"),K()(),Zt(19,gc,10,3,"div",13),K()(),J(20,"div",14)(21,"span",6),ae(22,"Create Room"),K(),J(23,"div",15),Zt(24,pc,2,0,"span",16)(25,yc,2,0,"span",17),J(26,"input",18),it("ngModelChange",function(u){return rt(f.roomName,u)||(f.roomName=u),u}),K(),Zt(27,bc,1,1,"input",19),J(28,"div",20)(29,"span",21),ae(30,"Private room?"),K(),J(31,"input",22),it("ngModelChange",function(u){return rt(f.isPrivate,u)||(f.isPrivate=u),u}),K()(),J(32,"button",23),wt("click",function(){return f.createRoom()}),ae(33,"Submit"),K()()(),J(34,"div",14)(35,"span",6),ae(36,"Join Room"),K(),J(37,"div",15)(38,"span",24),ae(39,"Private"),K(),J(40,"input",25),it("ngModelChange",function(u){return rt(f.privateRoomName,u)||(f.privateRoomName=u),u}),K(),J(41,"input",26),it("ngModelChange",function(u){return rt(f.joinPass,u)||(f.joinPass=u),u}),K(),J(42,"button",27),wt("click",function(){return f.joinPrivateRoom()}),ae(43,"Join"),K()(),J(44,"div",15)(45,"span",24),ae(46,"Random"),K(),J(47,"button",28),ae(48,"Join Random"),K()()(),J(49,"div",14)(50,"span",6),ae(51,"Play AI"),K(),J(52,"div",15)(53,"button",27),wt("click",function(){return f.joinAiGame()}),ae(54,"Play"),K()()()()),a&2&&(be(3),Je("headerLinks",f.headerLinks)("colorTheme","white"),be(7),nt("ngModel",f.selectedDeck),Je("formControl",f.deckSelect),be(),hi(f.decks),be(8),Je("ngForOf",f.roomList),be(5),Je("ngIf",!f.validRoomName),be(),Je("ngIf",!f.validRoomPass),be(),nt("ngModel",f.roomName),be(),Je("ngIf",f.isPrivate),be(4),nt("ngModel",f.isPrivate),be(9),nt("ngModel",f.privateRoomName),be(),nt("ngModel",f.joinPass))},dependencies:[gi,pi,Bi,Ii,Ni,Mi,Oi,_i,Ti,Ci,Pi,Di,Fi],styles:[".nav-button[_ngcontent-%COMP%]{width:45px!important;height:45px!important}.nav-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{width:42px!important;height:42px!important;line-height:24px!important}.nav-button[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:42px!important}"]})}}return t})();var wc=[{path:"",children:[{path:"",pathMatch:"full",component:_o}]}],Co=(()=>{class t{static{this.\u0275fac=function(a){return new(a||t)}}static{this.\u0275mod=Gt({type:t})}static{this.\u0275inj=Yt({imports:[$n.forChild(wc),$n]})}}return t})();var Mf=(()=>{class t{static{this.\u0275fac=function(a){return new(a||t)}}static{this.\u0275mod=Gt({type:t})}static{this.\u0275inj=Yt({imports:[yi,Ui,Co,bi,vi,Si,Ai,Li,ki,$i,ji]})}}return t})();export{Mf as LobbyModule};
